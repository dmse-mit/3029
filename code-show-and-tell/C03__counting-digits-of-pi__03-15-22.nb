(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67731,       1868]
NotebookOptionsPosition[     59155,       1698]
NotebookOutlinePosition[     59581,       1715]
CellTagsIndexPosition[     59538,       1712]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Counting Digits of \[Pi]", "Section",
 CellChangeTimes->{{3.856272661284726*^9, 3.856272667693096*^9}, 
   3.856285941285577*^9},ExpressionUUID->"e3540a38-8e28-4737-a164-\
548e4141c713"],

Cell[CellGroupData[{

Cell["Based on this youtube video", "Item",
 CellChangeTimes->{{3.856363516231532*^9, 
  3.856363529925762*^9}},ExpressionUUID->"337dd60c-4f7d-4ee3-9e44-\
5687c1bef94b"],

Cell["https://www.youtube.com/watch?v=HEfHFsfGXjs", "Subitem",
 CellChangeTimes->{{3.856363516231532*^9, 
  3.856363530766719*^9}},ExpressionUUID->"04497284-e671-4c50-bea3-\
b55fe418a37f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Looking a little harder, turns out there\[CloseCurlyQuote]s a stack-exchange \
solution from 2020\
\>", "Item",
 CellChangeTimes->{{3.856363594048931*^9, 
  3.8563636243529453`*^9}},ExpressionUUID->"756c4a52-7754-4ca2-9f5b-\
79aaacef5cc8"],

Cell["\<\
https://mathematica.stackexchange.com/questions/230170/perpectly-elastic-\
collision-pi-model \
\>", "Subitem",
 CellChangeTimes->{{3.856363594048931*^9, 
  3.856363640289967*^9}},ExpressionUUID->"81ea7a02-6569-45c3-8651-\
c22c016d75ad"],

Cell["let\[CloseCurlyQuote]s start by looking at this code", "Subitem",
 CellChangeTimes->{{3.856363594048931*^9, 
  3.8563636508305273`*^9}},ExpressionUUID->"21bffb01-a3de-4639-bf44-\
bf7f047102ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
In 1D, we can compute the outgoing velocity of two colliding blocks by using \
two conservation laws:\
\>", "Item",
 CellChangeTimes->{{3.856274120017479*^9, 3.85627412377988*^9}, {
  3.85627415896387*^9, 3.856274160860313*^9}, {3.856363925506132*^9, 
  3.856363959239107*^9}},ExpressionUUID->"42e2a116-a18b-49ca-9597-\
c5100a9a97c6"],

Cell[CellGroupData[{

Cell[TextData[{
 "Momentum ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"\[Sum]", "mv"}], ")"}], TraditionalForm]], "Item",
  FormatType->TraditionalForm,ExpressionUUID->
  "dd73225e-a1e9-4de3-bcae-430893eae832"],
 " & Energy ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"\[Sum]", 
     RowBox[{
      FractionBox["1", "2"], 
      SuperscriptBox["mv", "2"]}]}], ")"}], TraditionalForm]], "Item",
  FormatType->TraditionalForm,ExpressionUUID->
  "26b6dea6-e8e8-41d6-ab5e-def0392bc156"]
}], "Subitem",
 CellChangeTimes->{{3.856274120017479*^9, 3.85627412377988*^9}, {
  3.85627415896387*^9, 3.856274160860313*^9}, {3.856363925506132*^9, 
  3.856363995676037*^9}},ExpressionUUID->"1b9c48fa-8259-45da-8df4-\
632a7c8e77a1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"conservationLaws", "[", "1", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", "1", "]"}], 
         RowBox[{"u", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"m", "[", "2", "]"}], 
         RowBox[{"u", "[", "2", "]"}]}]}], "==", 
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", "1", "]"}], 
         RowBox[{"v", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"m", "[", "2", "]"}], 
         RowBox[{"v", "[", "2", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"m", "[", "1", "]"}], 
         SuperscriptBox[
          RowBox[{"u", "[", "1", "]"}], "2"]}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"m", "[", "2", "]"}], 
         SuperscriptBox[
          RowBox[{"u", "[", "2", "]"}], "2"]}]}], "==", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"m", "[", "1", "]"}], 
         SuperscriptBox[
          RowBox[{"v", "[", "1", "]"}], "2"]}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"m", "[", "2", "]"}], 
         SuperscriptBox[
          RowBox[{"v", "[", "2", "]"}], "2"]}]}]}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"conservationLaws", "[", "1", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "2", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.856274162539603*^9, 3.85627426462184*^9}, {
   3.856274342559701*^9, 3.856274359045146*^9}, 3.856363921460548*^9, 
   3.856364037176689*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"91cfcbec-67ed-4f87-8c1e-3de2fe4514e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
      RowBox[{"u", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
      RowBox[{"u", "[", "2", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", "1", "]"}], " ", 
         RowBox[{"u", "[", "1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"m", "[", "2", "]"}], " ", 
         RowBox[{"u", "[", "1", "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"m", "[", "2", "]"}], " ", 
         RowBox[{"u", "[", "2", "]"}]}]}], 
       RowBox[{
        RowBox[{"m", "[", "1", "]"}], "+", 
        RowBox[{"m", "[", "2", "]"}]}]]}], ",", 
     RowBox[{
      RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"m", "[", "1", "]"}], " ", 
         RowBox[{"u", "[", "1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"m", "[", "1", "]"}], " ", 
         RowBox[{"u", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"m", "[", "2", "]"}], " ", 
         RowBox[{"u", "[", "2", "]"}]}]}], 
       RowBox[{
        RowBox[{"m", "[", "1", "]"}], "+", 
        RowBox[{"m", "[", "2", "]"}]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.856274265549911*^9, 3.856274359393696*^9, 
  3.856364043819645*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"af13c981-c30f-4009-ba5d-815bbe2e9957"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The SE code uses this principle to compute the new velocities at each \
collision\
\>", "Subitem",
 CellChangeTimes->{{3.856364111807088*^9, 
  3.856364127931761*^9}},ExpressionUUID->"1b34a141-cab5-4121-8a51-\
7c825592452e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"numericSolution", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"collisions", "=", "0"}], ",", 
       RowBox[{"m1", "=", "1"}], ",", 
       RowBox[{"m2", "=", 
        SuperscriptBox["100", 
         RowBox[{"d", "-", "1"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"x10", "=", "1"}], ",", 
       RowBox[{"x20", "=", "2"}], ",", 
       RowBox[{"v10", "=", "0"}], ",", 
       RowBox[{"v20", "=", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"tmax", "=", "20"}], ",", "\[IndentingNewLine]", "etot", ",", 
       "newvelocity", ",", "vsol", ",", "sol"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"etot", "=", 
       RowBox[{
        RowBox[{"m1", " ", 
         RowBox[{"v10", "^", "2"}]}], "+", 
        RowBox[{"m2", " ", 
         RowBox[{"v20", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newvelocity", "[", 
        RowBox[{"vv1_", ",", "vv2_"}], "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "tsol", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tsol", "=", 
           RowBox[{"Quiet", "[", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"m1", " ", "vn1"}], "+", 
                  RowBox[{"m2", " ", "vn2"}]}], "==", 
                 RowBox[{
                  RowBox[{"m1", " ", "vv1"}], "+", 
                  RowBox[{"m2", " ", "vv2"}]}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"m1", " ", 
                   RowBox[{"vn1", "^", "2"}]}], "+", 
                  RowBox[{"m2", " ", 
                   RowBox[{"vn2", "^", "2"}]}]}], "==", "etot"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"vn1", ",", "vn2"}], "}"}]}], "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vn1", ",", "vn2"}], "}"}], "/.", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sign", "[", 
               RowBox[{"tsol", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "!=", 
              RowBox[{"Sign", "[", "vv1", "]"}]}], ",", 
             RowBox[{"tsol", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"tsol", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolveValue", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x1", "'"}], "[", "t", "]"}], "==", 
            RowBox[{"v1", "[", "t", "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "'"}], "[", "t", "]"}], "==", 
            RowBox[{"v2", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"x1", "[", "0", "]"}], "==", "x10"}], ",", 
           RowBox[{
            RowBox[{"x2", "[", "0", "]"}], "==", "x20"}], ",", 
           RowBox[{
            RowBox[{"v1", "[", "0", "]"}], "==", "v10"}], ",", 
           RowBox[{
            RowBox[{"v2", "[", "0", "]"}], "==", "v20"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "==", 
              RowBox[{"x2", "[", "t", "]"}]}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"collisions", "+=", "1"}], ",", "\[IndentingNewLine]", 
               
               RowBox[{"vsol", "=", 
                RowBox[{"newvelocity", "[", 
                 RowBox[{
                  RowBox[{"v1", "[", "t", "]"}], ",", 
                  RowBox[{"v2", "[", "t", "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"v1", "[", "t", "]"}], "->", 
                RowBox[{"vsol", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"v2", "[", "t", "]"}], "->", 
                RowBox[{"vsol", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
              "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "==", "0"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"collisions", "+=", "1"}], ",", "\[IndentingNewLine]", 
               
               RowBox[{
                RowBox[{"v1", "[", "t", "]"}], "->", 
                RowBox[{"-", 
                 RowBox[{"v1", "[", "t", "]"}]}]}]}], "\[IndentingNewLine]", 
              "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2", ",", "v1", ",", "v2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
         RowBox[{"DiscreteVariables", "->", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Echo", "[", "collisions", "]"}], ";", "\[IndentingNewLine]", 
      "sol"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.856363662694736*^9, 3.8563636699594383`*^9}, {
   3.8563641345882587`*^9, 3.856364136142069*^9}, {3.856364174281249*^9, 
   3.856364177010219*^9}, 3.85636420752215*^9, {3.856364384670065*^9, 
   3.8563643854095907`*^9}, {3.856364466878656*^9, 3.8563644906387*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"9d22f2c8-6811-436b-8d93-7f42915ee273"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"numericSolution", "[", "4", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8563644599891777`*^9, 3.8563644601345243`*^9}, {
  3.856364493899357*^9, 3.8563644947532997`*^9}, {3.8563645896838903`*^9, 
  3.856364602132492*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"a46c8b84-4362-47ee-804b-c68f0a2a1bf0"],

Cell[BoxData["3141"], "Echo",
 CellChangeTimes->{
  3.856364619570005*^9},ExpressionUUID->"fb276bcc-c1ce-4a0b-9548-\
d604f8248521"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elastic Collisions Simulation", "Item",
 CellChangeTimes->{{3.8563018431274242`*^9, 3.8563018614077587`*^9}, {
  3.856303602556426*^9, 
  3.856303610029533*^9}},ExpressionUUID->"32e55dc2-dd4c-470c-b1af-\
7db96d42ecf0"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"events", "=", 
        RowBox[{"eventsList", "[", "d", "]"}]}], ",", "\[IndentingNewLine]", 
       "interpolators", ",", "times"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"times", "=", 
       RowBox[{"events", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"interpolators", "=", 
       RowBox[{"positionsInterpolator", "[", "events", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"visualizeBlocks", "[", 
          RowBox[{"t", ",", "times"}], "]"}], "[", "interpolators", "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "\"\<Time\>\""}], "}"}], ",", "0", ",", 
          RowBox[{"Last", "[", "times", "]"}]}], "}"}], ",", 
        RowBox[{"AnimationRepetitions", "\[Rule]", "1"}], ",", 
        RowBox[{"Paneled", "\[Rule]", "False"}], ",", 
        RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]}], ",", 
     RowBox[{"DynamicEvaluationTimeout", "->", "100"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "\"\<Digits of \[Pi]\>\""}], "}"}], ",", 
     RowBox[{"Range", "[", "6", "]"}], ",", "SetterBar"}], "}"}], ",", 
   RowBox[{"Paneled", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.856283950412837*^9, 3.8562840567979813`*^9}, {
   3.856284090413224*^9, 3.856284140654235*^9}, {3.856284226744787*^9, 
   3.856284250304587*^9}, {3.856284348590479*^9, 3.8562843712059593`*^9}, {
   3.856284401653924*^9, 3.856284402310423*^9}, {3.856284547698246*^9, 
   3.856284548683865*^9}, {3.8562846993949223`*^9, 3.8562847028394203`*^9}, {
   3.856284817128112*^9, 3.856284821113389*^9}, {3.8562848989771137`*^9, 
   3.856284909177801*^9}, {3.856285095663941*^9, 3.85628510200113*^9}, {
   3.856285210022114*^9, 3.85628521259137*^9}, {3.856285270218129*^9, 
   3.8562852710214443`*^9}, {3.856285317114171*^9, 3.85628536003476*^9}, {
   3.856285510184143*^9, 3.856285544162629*^9}, {3.856285579344709*^9, 
   3.8562855837411623`*^9}, {3.856285685903186*^9, 3.856285698190295*^9}, {
   3.8563016442437973`*^9, 3.856301646163261*^9}, 3.856301679825923*^9, {
   3.856364648819805*^9, 3.856364652276628*^9}, {3.856364687701955*^9, 
   3.856364692555563*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"dc8d6c93-f4f7-40aa-9ece-d3359fa6b88b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization Code", "Section",
 CellChangeTimes->{{3.856285948128902*^9, 
  3.856285951986888*^9}},ExpressionUUID->"5d5cc657-42b2-4c8c-b470-\
d6a0208b6d28"],

Cell[CellGroupData[{

Cell["Collision Times", "Subsection",
 CellChangeTimes->{{3.8562740690431557`*^9, 
  3.8562740708776417`*^9}},ExpressionUUID->"e66832d3-9345-47d4-8e87-\
9b914aa5ed9a"],

Cell[CellGroupData[{

Cell["Collision between 2 particles", "Item",
 CellChangeTimes->{{3.856272716581414*^9, 3.85627274223892*^9}, {
  3.856272831558826*^9, 
  3.85627283155941*^9}},ExpressionUUID->"01eea97e-2a49-4bd5-bb3c-\
a336d5c7768a"],

Cell[CellGroupData[{

Cell[TextData[{
 "Assumed to be a distance ",
 StyleBox["r",
  FontSlant->"Italic"],
 " apart"
}], "Subitem",
 CellChangeTimes->{{3.856272716581414*^9, 3.85627274223892*^9}, {
  3.856272832102268*^9, 
  3.856272839387556*^9}},ExpressionUUID->"c58faefd-29a0-4a38-9d61-\
2cb3c850315e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trajectory1", "  ", "=", " ", 
   RowBox[{"x1", " ", "+", " ", 
    RowBox[{"v1", " ", "t"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trajectory2", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x1", " ", "+", " ", "\[CapitalDelta]x"}], ")"}], "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"v1", " ", "+", " ", "\[CapitalDelta]v"}], ")"}], " ", 
     "t"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.856272843083021*^9, 3.8562728590180264`*^9}, {
  3.867871932125759*^9, 3.8678719397024*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0fc2b71c-7ec0-43f1-9196-8c1c7dd5cf76"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"separationSquared", " ", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"delta", " ", "=", " ", 
       RowBox[{"trajectory2", "-", " ", "trajectory1"}]}], "}"}], ",", " ", 
     RowBox[{"delta", ".", "delta"}]}], "]"}], "]"}]}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"8c0229ba-1b09-4bcc-a891-8f3f1a579f2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"t", " ", "\[CapitalDelta]v"}], "+", "\[CapitalDelta]x"}], ")"}], 
  ".", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"t", " ", "\[CapitalDelta]v"}], "+", "\[CapitalDelta]x"}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.85627287431798*^9, 3.856272964394804*^9, 
  3.856364909072872*^9, 3.86787194913684*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"a5d0cca1-d3c8-4bc5-88cb-5ada5e209cf8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let\[CloseCurlyQuote]s help Mathematica out a bit by introducing simple \
multiplication rules\
\>", "Subitem",
 CellChangeTimes->{{3.8562729052285137`*^9, 3.856272928328951*^9}, {
  3.856273213870994*^9, 
  3.856273214105537*^9}},ExpressionUUID->"c31b5121-af9a-4b97-a8a9-\
4c07d119affd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Distribute", "[", "separationSquared", "]"}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"ba9523da-2e62-428a-9e85-f4ce3afddd34"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"t", " ", "\[CapitalDelta]v"}], ")"}], ".", 
   RowBox[{"(", 
    RowBox[{"t", " ", "\[CapitalDelta]v"}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"t", " ", "\[CapitalDelta]v"}], ")"}], ".", "\[CapitalDelta]x"}], 
  "+", 
  RowBox[{"\[CapitalDelta]x", ".", 
   RowBox[{"(", 
    RowBox[{"t", " ", "\[CapitalDelta]v"}], ")"}]}], "+", 
  RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]x"}]}]], "Output",
 CellChangeTimes->{3.856364951428582*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"5fe3c867-71f7-412a-8a46-dc53de3dbbe0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"separationSquared", " ", "=", " ", 
  RowBox[{
   RowBox[{"Distribute", "[", "separationSquared", "]"}], "//.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", " ", "a_"}], " ", ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"t", " ", "b_"}], ")"}]}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{"t", "^", "2"}], " ", 
       RowBox[{"a", ".", "b"}]}]}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", " ", "a_", " ", ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"t", " ", "b_"}], ")"}]}], "\[RuleDelayed]", "  ", 
      RowBox[{"t", " ", 
       RowBox[{"a", ".", "b"}]}]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", " ", 
        RowBox[{"t", " ", "a_"}], " ", ")"}], ".", 
       RowBox[{"(", " ", "b_", ")"}]}], "\[RuleDelayed]", "  ", 
      RowBox[{"t", " ", 
       RowBox[{"a", ".", "b"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[CapitalDelta]v", ".", "\[CapitalDelta]x"}], ")"}], 
      "\[RuleDelayed]", " ", 
      RowBox[{"(", " ", 
       RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]v"}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8562729301953697`*^9, 3.856272968916012*^9}, {
   3.856273146420175*^9, 3.856273147742395*^9}, 3.856277750670864*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"6ce56261-f40c-4133-bcfc-8508f472fbb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["t", "2"], " ", 
   RowBox[{"\[CapitalDelta]v", ".", "\[CapitalDelta]v"}]}], "+", 
  RowBox[{"2", " ", "t", " ", 
   RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]v"}]}], "+", 
  RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]x"}]}]], "Output",
 CellChangeTimes->{{3.856272955857134*^9, 3.8562729692435207`*^9}, 
   3.856273152633724*^9, 3.85627779548252*^9, 3.8563650142979116`*^9, {
   3.8678724333136063`*^9, 3.86787244351332*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"199b6d53-6870-40f7-a0e9-ecd2bcb36d45"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"firstCollision", ",", "secondCollision"}], "}"}], "=", 
  RowBox[{"t", "/.", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"separationSquared", " ", "\[Equal]", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "r"}], ")"}], "^", "2"}]}], ",", "t"}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.856273015380657*^9, 3.856273030858491*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"3d899bba-1317-4601-8252-4dea89c77349"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]v"}], "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]v"}], ")"}], "2"], 
        "+", 
        RowBox[{
         RowBox[{"\[CapitalDelta]v", ".", "\[CapitalDelta]v"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["r", "2"]}], "-", 
           RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]x"}]}], 
          ")"}]}]}]]}], 
     RowBox[{"\[CapitalDelta]v", ".", "\[CapitalDelta]v"}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]v"}]}], "+", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]v"}], ")"}], "2"], 
       "+", 
       RowBox[{
        RowBox[{"\[CapitalDelta]v", ".", "\[CapitalDelta]v"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["r", "2"]}], "-", 
          RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]x"}]}], 
         ")"}]}]}]]}], 
    RowBox[{"\[CapitalDelta]v", ".", "\[CapitalDelta]v"}]]}], "}"}]], "Output",\

 CellChangeTimes->{3.856273031158148*^9, 3.856273153539488*^9, 
  3.8563650528458223`*^9, 3.867924853853899*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"0c27acff-c49c-4c92-82ab-bf3629bb5876"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["And write a general function to compute the collision time", "Item",
 CellChangeTimes->{{3.856273132165262*^9, 3.856273139009111*^9}, {
  3.856273178966476*^9, 3.8562731817783318`*^9}, {3.8562733839680433`*^9, 
  3.856273383970469*^9}},ExpressionUUID->"1a12604b-4451-4ee6-8e8d-\
dfa1a232a102"],

Cell[CellGroupData[{

Cell["Assuming r = 1/2 for simplicity", "Subitem",
 CellChangeTimes->{{3.856273132165262*^9, 3.856273139009111*^9}, {
  3.856273178966476*^9, 3.8562731817783318`*^9}, {3.8562733848878202`*^9, 
  3.8562733956398363`*^9}, {3.856274049972434*^9, 
  3.856274063572249*^9}},ExpressionUUID->"d9bb1445-4c88-4b9d-b372-\
6037dae655c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]v"}], ")"}], "2"], "+", 
    RowBox[{
     RowBox[{"\[CapitalDelta]v", ".", "\[CapitalDelta]v"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["r", "2"]}], "-", 
       RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]x"}]}], ")"}]}]}], "/.", 
   RowBox[{"r", "->", 
    RowBox[{"1", "/", "2"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.856273339774671*^9, 3.8562733692307873`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"cfb6d6cd-88a7-4846-ad69-76f67ad5ffa8"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]v"}], ")"}], "2"], "-", 
  RowBox[{
   RowBox[{"\[CapitalDelta]v", ".", "\[CapitalDelta]v"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"\[CapitalDelta]x", ".", "\[CapitalDelta]x"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8562733419219427`*^9, 3.856273369775715*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"a0a8be7a-4ad2-48b9-b003-d0cc295c3bb2"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "particleParticleCollisionTime", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"particleParticleCollisionTime", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", ":", 
      RowBox[{"{", 
       RowBox[{"m1_", ",", "x1_", ",", "v1_"}], "}"}]}], ",", 
     RowBox[{"p2", ":", 
      RowBox[{"{", 
       RowBox[{"m2_", ",", "x2_", ",", "v2_"}], "}"}]}]}], "}"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dummyMass", ",", "dx", ",", "dv", ",", "dxdv", ",", "dvdv", ",", "dxdx",
       ",", " ", "rootTerm"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dummyMass", ",", "dx", ",", "dv"}], "}"}], "=", " ", 
      RowBox[{"p2", "-", "p1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dxdv", " ", "=", " ", 
      RowBox[{"dx", ".", "dv"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dxdv", " ", "\[GreaterEqual]", "  ", "0"}], ",", " ", 
       RowBox[{"Return", "[", "\[Infinity]", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dxdx", " ", "=", " ", 
      RowBox[{"dx", ".", "dx"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dvdv", " ", "=", " ", 
      RowBox[{"dv", ".", "dv"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rootTerm", " ", "=", " ", 
      RowBox[{
       RowBox[{"dxdv", "^", "2"}], " ", "+", " ", 
       RowBox[{"(", 
        RowBox[{"dvdv", 
         RowBox[{"(", 
          RowBox[{"1", "-", "dxdx"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rootTerm", " ", "<", "0"}], ",", 
       RowBox[{"Return", "[", "\[Infinity]", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"dxdv", " ", "+", " ", 
         RowBox[{"Sqrt", "[", "rootTerm", "]"}]}], ")"}]}], "/", "dvdv"}]}]}],
    " ", "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856273062793359*^9, 3.85627311018458*^9}, {
   3.856273271498431*^9, 3.8562732748618402`*^9}, {3.856273414096902*^9, 
   3.856273416161628*^9}, 3.856273446415059*^9, {3.8562803427114687`*^9, 
   3.856280343329824*^9}, {3.8562804570252047`*^9, 3.85628046295504*^9}, {
   3.856281302635415*^9, 3.856281308463852*^9}, {3.856281342273582*^9, 
   3.8562813637439137`*^9}, {3.8563652372786818`*^9, 3.856365258495511*^9}, {
   3.8563652924254923`*^9, 3.856365308438512*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"a6968cf7-73a6-4d9d-a38d-36c45d4265e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test for 1D particles", "Subitem",
 CellChangeTimes->{{3.856273188532205*^9, 
  3.856273192805338*^9}},ExpressionUUID->"b6aff870-fa63-46e3-926c-\
b311301663fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"particleParticleCollisionTime", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.856273186277429*^9, 3.856273187265707*^9}, {
  3.8562732306063633`*^9, 3.85627324830471*^9}, {3.856273449827959*^9, 
  3.8562734505576982`*^9}, {3.856273488717703*^9, 3.856273502727474*^9}, {
  3.856281333599223*^9, 3.8562813347754993`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"08c1cf9c-c978-4994-a3a8-412a55b18a2c"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.856273249732193*^9, 3.856273292973812*^9, 
  3.856273450914939*^9, 3.8562735031340437`*^9, 3.856277899092689*^9, 
  3.856281335129778*^9, 3.856281367618331*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"0135a6c9-3f25-4a38-96b5-8ff3158968cd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Works just as well for higher dimensions", "Subitem",
 CellChangeTimes->{{3.85627346274146*^9, 
  3.856273483034679*^9}},ExpressionUUID->"4cbd1d5b-76d7-42ef-8acd-\
966ad0612aca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"particleParticleCollisionTime", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8562734853641453`*^9, 3.856273520343906*^9}, {
  3.856281370123991*^9, 3.856281371517638*^9}, {3.8563655255214157`*^9, 
  3.85636554366369*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"05d485ff-df93-4da1-ae16-b210a0d05332"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.8562735068944197`*^9, 3.8562735205588217`*^9}, 
   3.8562779101609097`*^9, 3.8562813718147087`*^9, {3.8563655282664967`*^9, 
   3.856365543943466*^9}},
 CellLabel->"Out[37]=",ExpressionUUID->"9e41f875-9cd1-41b1-b6f4-355866c1e802"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This allows us to write a simple function to return the position of particles \
at time t\
\>", "Item",
 CellChangeTimes->{{3.856280529776314*^9, 
  3.856280552297552*^9}},ExpressionUUID->"b6dc93f0-001d-4232-885a-\
bebe504fe44f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"particleStateAtTime", "[", 
   RowBox[{
    RowBox[{"particle", ":", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "x_", ",", "v_"}], "}"}]}], ",", "time_"}], "]"}], ":=",
   " ", 
  RowBox[{"{", 
   RowBox[{"m", ",", 
    RowBox[{"x", "+", " ", 
     RowBox[{"time", " ", "v"}]}], ",", "v"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856280655665894*^9, 3.856280667446601*^9}, {
  3.856281278598548*^9, 3.856281287774735*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"b433d2f0-7ff2-47f5-a277-0ada65de98c4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocities Post Collision", "Subsection",
 CellChangeTimes->{{3.856274076902174*^9, 
  3.856274080271402*^9}},ExpressionUUID->"7e14c8ce-117e-4c45-995e-\
4cf9a15fd42c"],

Cell["\<\
We can find the velocities post collision using energy and \
momentum-conservation\
\>", "Item",
 CellChangeTimes->{{3.856274136012671*^9, 
  3.85627415380425*^9}},ExpressionUUID->"ece95725-a3e3-4917-a054-\
9f39993cb23f"],

Cell[CellGroupData[{

Cell["In 1D", "Item",
 CellChangeTimes->{{3.856274120017479*^9, 3.85627412377988*^9}, {
  3.85627415896387*^9, 
  3.856274160860313*^9}},ExpressionUUID->"6bcbfd7b-992c-44ca-b680-\
a761ab00edd3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"conservationLaws", "[", "1", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"m", "[", "1", "]"}], 
        RowBox[{"u", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"m", "[", "2", "]"}], 
        RowBox[{"u", "[", "2", "]"}]}]}], "==", 
      RowBox[{
       RowBox[{
        RowBox[{"m", "[", "1", "]"}], 
        RowBox[{"v", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"m", "[", "2", "]"}], 
        RowBox[{"v", "[", "2", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"m", "[", "1", "]"}], 
        SuperscriptBox[
         RowBox[{"u", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"m", "[", "2", "]"}], 
        SuperscriptBox[
         RowBox[{"u", "[", "2", "]"}], "2"]}]}], "==", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"m", "[", "1", "]"}], 
        SuperscriptBox[
         RowBox[{"v", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"m", "[", "2", "]"}], 
        SuperscriptBox[
         RowBox[{"v", "[", "2", "]"}], "2"]}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"conservationLaws", "[", "1", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "2", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.856274162539603*^9, 3.85627426462184*^9}, {
  3.856274342559701*^9, 3.856274359045146*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"8417ddc5-9cbe-4567-80d5-8f741ed4d6f0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
      RowBox[{"u", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
      RowBox[{"u", "[", "2", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", "1", "]"}], " ", 
         RowBox[{"u", "[", "1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"m", "[", "2", "]"}], " ", 
         RowBox[{"u", "[", "1", "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"m", "[", "2", "]"}], " ", 
         RowBox[{"u", "[", "2", "]"}]}]}], 
       RowBox[{
        RowBox[{"m", "[", "1", "]"}], "+", 
        RowBox[{"m", "[", "2", "]"}]}]]}], ",", 
     RowBox[{
      RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"m", "[", "1", "]"}], " ", 
         RowBox[{"u", "[", "1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"m", "[", "1", "]"}], " ", 
         RowBox[{"u", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"m", "[", "2", "]"}], " ", 
         RowBox[{"u", "[", "2", "]"}]}]}], 
       RowBox[{
        RowBox[{"m", "[", "1", "]"}], "+", 
        RowBox[{"m", "[", "2", "]"}]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.856274265549911*^9, 3.856274359393696*^9, 
  3.856365626766984*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"f8d825df-5a6f-4472-9130-025ae9b14ba1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["In higher dimensions", "Item",
 CellChangeTimes->{{3.8562743285169497`*^9, 3.856274332631065*^9}, {
  3.8562750579824533`*^9, 
  3.8562750597817907`*^9}},ExpressionUUID->"39a9d2f0-2eb7-4505-97c4-\
bb1cd0eff331"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bounceVelocitiesAfterCollision", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", ":", 
      RowBox[{"{", 
       RowBox[{"m1_", ",", "x1_", ",", "v1_"}], "}"}]}], ",", 
     RowBox[{"p2", ":", 
      RowBox[{"{", 
       RowBox[{"m2_", ",", "x2_", ",", "v2_"}], "}"}]}]}], "}"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dv", "=", 
       RowBox[{"v2", "-", "v1"}]}], ",", 
      RowBox[{"dx", "=", 
       RowBox[{"x2", "-", "x1"}]}], ",", "deltaV", ",", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"m1", " ", 
        RowBox[{"m2", "/", 
         RowBox[{"(", 
          RowBox[{"m1", "+", "m2"}], ")"}]}]}]}], ",", "\[Delta]v"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Delta]v", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"dv", ".", "dx"}], 
        RowBox[{"(", "dx", ")"}]}], 
       RowBox[{"dx", ".", "dx"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m1", ",", "x1", ",", 
         RowBox[{"v1", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"2", "\[Mu]"}], "m1"], "\[Delta]v"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"m2", ",", "x2", ",", 
         RowBox[{"v2", "-", 
          RowBox[{
           FractionBox[
            RowBox[{"2", "\[Mu]"}], "m2"], "\[Delta]v"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856274430511551*^9, 3.856274443756979*^9}, {
   3.856274601250766*^9, 3.856274665001753*^9}, {3.856274706211307*^9, 
   3.8562748360175962`*^9}, {3.856274899041259*^9, 3.8562749056624117`*^9}, {
   3.85628144736721*^9, 3.856281453178808*^9}, {3.856281496906053*^9, 
   3.856281502345624*^9}, 3.856281533531755*^9, {3.85628160024755*^9, 
   3.8562816023015413`*^9}, {3.856365748375306*^9, 3.856365783551528*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"ebe75040-4d2a-4dc6-80ff-c8bea3df6470"],

Cell[CellGroupData[{

Cell["\<\
Specializing to \[OpenCurlyDoubleQuote]immovable\[CloseCurlyDoubleQuote] \
objects (i.e. rigid walls w/ mass \[Rule] \[Infinity])\
\>", "Subitem",
 CellChangeTimes->{{3.85627516348909*^9, 3.856275187257223*^9}, 
   3.8563658733008633`*^9},ExpressionUUID->"9c58ec86-2d9d-4951-8baf-\
a95f554e1bc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bounceVelocitiesAfterCollision", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", ":", 
       RowBox[{"{", 
        RowBox[{"\[Infinity]", ",", "x1_", ",", "v1_"}], "}"}]}], ",", 
      RowBox[{"p2", ":", 
       RowBox[{"{", 
        RowBox[{"m2_", ",", "x2_", ",", "v2_"}], "}"}]}]}], "}"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dv", "=", "v2"}], ",", 
       RowBox[{"dx", "=", 
        RowBox[{"x2", "-", "x1"}]}], ",", "deltaV", ",", "\[Delta]v"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Delta]v", "=", 
       FractionBox[
        RowBox[{
         RowBox[{"dv", ".", "dx"}], 
         RowBox[{"(", "dx", ")"}]}], 
        RowBox[{"dx", ".", "dx"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Infinity]", ",", "x1", ",", "v1"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"m2", ",", "x2", ",", 
          RowBox[{"v2", "-", 
           RowBox[{"2", "\[Delta]v"}]}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bounceVelocitiesAfterCollision", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", ":", 
      RowBox[{"{", 
       RowBox[{"m1_", ",", "x1_", ",", "v1_"}], "}"}]}], ",", 
     RowBox[{"p2", ":", 
      RowBox[{"{", 
       RowBox[{"\[Infinity]", ",", "x2_", ",", "v2_"}], "}"}]}]}], "}"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dv", "=", 
       RowBox[{"-", "v1"}]}], ",", 
      RowBox[{"dx", "=", 
       RowBox[{"x2", "-", "x1"}]}], ",", "deltaV", ",", "\[Delta]v"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Delta]v", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"dv", ".", "dx"}], 
        RowBox[{"(", "dx", ")"}]}], 
       RowBox[{"dx", ".", "dx"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m1", ",", "x1", ",", 
         RowBox[{"v1", "+", 
          RowBox[{"2", " ", "\[Delta]v"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Infinity]", ",", "x2", ",", "v2"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856275197617971*^9, 3.856275228433312*^9}, {
  3.8562753151908817`*^9, 3.8562753983830767`*^9}, {3.8562814590446033`*^9, 
  3.8562815528133707`*^9}, {3.856281606880796*^9, 3.856281609120635*^9}, {
  3.8563659611922417`*^9, 3.856365967463225*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"1fa6d5a6-1461-4355-837f-e2f8192f9659"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup", "Subsection",
 CellChangeTimes->{{3.856275545896576*^9, 3.856275548492414*^9}, {
  3.856275641705632*^9, 
  3.856275643368742*^9}},ExpressionUUID->"20c4429b-a8ca-4f03-89a9-\
c8b86c0a585d"],

Cell[CellGroupData[{

Cell["Three blocks", "Item",
 CellChangeTimes->{{3.856275873538698*^9, 
  3.856275876454424*^9}},ExpressionUUID->"78deaaed-f117-4381-9e5e-\
ff529b4229ba"],

Cell["An \[OpenCurlyDoubleQuote]immovable\[CloseCurlyDoubleQuote] rigid wall \
with m \[Rule] \[Infinity]", "Subitem",
 CellChangeTimes->{{3.856275873538698*^9, 
  3.8562759037265244`*^9}},ExpressionUUID->"7f9e497f-a60a-4946-b627-\
726b6c0c1bf5"],

Cell["A stationary blue block with m = 1", "Subitem",
 CellChangeTimes->{{3.856275873538698*^9, 
  3.856275928198777*^9}},ExpressionUUID->"182bd1f0-b22b-4442-b362-\
e1c0675954c7"],

Cell[CellGroupData[{

Cell[TextData[{
 "A red block moving towards the blue block with m = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["100", 
    RowBox[{"d", "-", "1"}]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6474283e-5e26-43e4-827c-f66714664a09"]
}], "Subitem",
 CellChangeTimes->{{3.856275873538698*^9, 3.856275943964329*^9}, {
  3.856282116997388*^9, 
  3.856282119804634*^9}},ExpressionUUID->"ad82173d-a49d-4072-a7b6-\
c47bf94c67e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"particleStates", "[", "d_", "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Infinity]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["100", 
       RowBox[{"d", "-", "1"}]], ",", 
      RowBox[{"{", "5", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856280783145657*^9, 3.856280819885676*^9}, {
   3.856281260084794*^9, 3.856281264526613*^9}, 3.8562821275367813`*^9, {
   3.8562848610487432`*^9, 3.8562848741529016`*^9}, 3.8563015146707973`*^9, {
   3.856301621658231*^9, 3.856301624825645*^9}, {3.8563016683308907`*^9, 
   3.85630166941894*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"d2f54025-dc63-4054-91d6-2ac02b9b86d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"visualizeBlocks", "[", 
   RowBox[{"particleStates", ":", 
    RowBox[{"{", 
     RowBox[{"wall_", ",", "blue_", ",", "red_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Dashed"}], "]"}], "]"}], ",", 
        RowBox[{"FaceForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "10"}], ",", 
            RowBox[{"-", "10"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
             RowBox[{"1", "/", "2"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
             RowBox[{"1", "/", "2"}]}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
             RowBox[{"1", "/", "2"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
             RowBox[{"1", "/", "2"}]}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.856282213277512*^9, 3.8562822366374807`*^9}, {
  3.85628226995927*^9, 3.856282355115546*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"29122662-4de0-4945-9845-5b61fc3c9859"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["As such, we have two possible collisions to consider", "Item",
 CellChangeTimes->{{3.856277431350585*^9, 
  3.856277453390151*^9}},ExpressionUUID->"a1b92e4f-ed47-465f-bb78-\
0c4d406acc1e"],

Cell["Blue block colliding with the wall", "Subitem",
 CellChangeTimes->{{3.856277431350585*^9, 
  3.856277461902174*^9}},ExpressionUUID->"6e03976a-e4fd-41d5-a94b-\
7d217dcfb9cd"],

Cell["Blue block colliding with the red block", "Subitem",
 CellChangeTimes->{{3.856277431350585*^9, 
  3.856277471057671*^9}},ExpressionUUID->"0d7ff374-62b0-4712-b41d-\
fa4fe55af02b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["At each state, we will compute the two collision times", "Item",
 CellChangeTimes->{{3.856277477944333*^9, 
  3.856277497216095*^9}},ExpressionUUID->"8581feac-143c-4220-b276-\
0160c8a8d886"],

Cell["pick the smallest time", "Subitem",
 CellChangeTimes->{{3.856277477944333*^9, 
  3.856277502833606*^9}},ExpressionUUID->"e1247a19-b46b-4549-b03a-\
447c6d19074d"],

Cell["update positions and velocities", "Subitem",
 CellChangeTimes->{{3.856277477944333*^9, 
  3.856277507937694*^9}},ExpressionUUID->"c17dcefd-b1da-493d-a42c-\
4860ca6f19a0"],

Cell[CellGroupData[{

Cell["rinse and repeat", "Subitem",
 CellChangeTimes->{{3.856277477944333*^9, 
  3.856277511747611*^9}},ExpressionUUID->"a313e9b8-5849-4c2f-9565-\
a3dd4f083afe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"findShortestCollisionTime", "[", 
    RowBox[{"{", 
     RowBox[{"t_", ",", 
      RowBox[{"particleStates", ":", 
       RowBox[{"{", 
        RowBox[{"wall_", ",", "blue_", ",", "red_"}], "}"}]}]}], "}"}], "]"}],
    ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"wallBlue", ",", "blueRed"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wallBlue", "=", 
       RowBox[{"particleParticleCollisionTime", "[", 
        RowBox[{"{", 
         RowBox[{"wall", ",", "blue"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"blueRed", "=", 
       RowBox[{"particleParticleCollisionTime", "[", 
        RowBox[{"{", 
         RowBox[{"blue", ",", "red"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"{", 
          RowBox[{"wallBlue", ",", "blueRed"}], "}"}], "]"}], ",", 
        RowBox[{"Ordering", "[", 
         RowBox[{"{", 
          RowBox[{"wallBlue", ",", "blueRed"}], "}"}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bounceParticlesAtShortestCollision", "[", 
   RowBox[{"{", 
    RowBox[{"t_", ",", 
     RowBox[{"particleStates", ":", 
      RowBox[{"{", 
       RowBox[{"wall_", ",", "blue_", ",", "red_"}], "}"}]}]}], "}"}], "]"}], 
  ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "time", ",", "ordering", ",", "preWall", ",", "preBlue", ",", "preRed", 
      ",", "post"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "ordering"}], "}"}], "=", 
      RowBox[{"findShortestCollisionTime", "[", 
       RowBox[{"{", 
        RowBox[{"t", ",", "particleStates"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"time", "==", "\[Infinity]"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"t", ",", "particleStates"}], "}"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"preWall", ",", "preBlue", ",", "preRed"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"particleStateAtTime", "[", 
         RowBox[{"#", ",", "time"}], "]"}], "&"}], "/@", "particleStates"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"post", "=", 
      RowBox[{"Switch", "[", 
       RowBox[{"ordering", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"bounceVelocitiesAfterCollision", "[", 
           RowBox[{"{", 
            RowBox[{"preWall", ",", "preBlue"}], "}"}], "]"}], ",", 
          "preRed"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], ",", 
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"bounceVelocitiesAfterCollision", "[", 
           RowBox[{"{", 
            RowBox[{"preBlue", ",", "preRed"}], "}"}], "]"}], ",", 
          "preWall"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t", "+", "time"}], ",", "post"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8562808354410763`*^9, 3.8562809905795603`*^9}, {
   3.856281674623192*^9, 3.856281700312223*^9}, {3.856282962852*^9, 
   3.856282972913589*^9}, {3.856283050779459*^9, 3.856283083449347*^9}, 
   3.8562838313415127`*^9, {3.8562859051833572`*^9, 3.856285905547427*^9}, {
   3.8563018202345657`*^9, 3.856301826596963*^9}, {3.856367073009708*^9, 
   3.856367094889721*^9}},ExpressionUUID->"d2d61eb8-f8d9-448e-a097-\
f98ac2e42715"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualization Functions", "Subsection",
 CellChangeTimes->{{3.856285492234601*^9, 
  3.856285494620859*^9}},ExpressionUUID->"bab57217-7c89-4de5-83e3-\
cbb29b430902"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"visualizeBlocks", "[", 
    RowBox[{"t_", ",", "times_"}], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
    "wall_InterpolatingFunction", ",", "blue_InterpolatingFunction", ",", 
     "red_InterpolatingFunction"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Dashed"}], "]"}], "]"}], ",", 
        RowBox[{"FaceForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "10"}], ",", 
            RowBox[{"-", "10"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"blue", "[", "t", "]"}], "-", 
             RowBox[{"1", "/", "2"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"blue", "[", "t", "]"}], "+", 
             RowBox[{"1", "/", "2"}]}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"red", "[", "t", "]"}], "-", 
             RowBox[{"1", "/", "2"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"red", "[", "t", "]"}], "+", 
             RowBox[{"1", "/", "2"}]}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{
      RowBox[{"StringTemplate", "[", "\"\<Collisions:`1`\>\"", "]"}], "[", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"FirstPosition", "[", 
         RowBox[{"times", ",", 
          RowBox[{"ts_", "/;", 
           RowBox[{"ts", ">", "t"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "times", "]"}], "+", "1"}], "}"}]}], "]"}],
         "]"}], "-", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8562839294084997`*^9, 3.85628393425465*^9}, {
  3.856284117180995*^9, 3.856284125958593*^9}, {3.856284190511043*^9, 
  3.856284217154333*^9}, {3.856284271628201*^9, 3.8562842732884903`*^9}, {
  3.856284407778513*^9, 3.8562844852024918`*^9}, {3.8562845308255873`*^9, 
  3.856284542848198*^9}, {3.856284620844449*^9, 3.856284643057879*^9}, {
  3.856284721315514*^9, 3.856284789730378*^9}, {3.85628528976923*^9, 
  3.856285309751268*^9}, {3.856285916969253*^9, 3.856285917429141*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"80bb15a1-847b-46fe-88f4-242228475d73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"positionsInterpolator", "[", "listOfEvents_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"times", "=", 
       RowBox[{"listOfEvents", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"positions1D", "=", 
       SuperscriptBox[
        RowBox[{"listOfEvents", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2", ",", "All", ",", "2", ",", "1"}], "]"}], 
         "]"}], "\[Transpose]"]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"N", "[", 
          RowBox[{"{", 
           RowBox[{"times", ",", "positions"}], "}"}], "]"}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"positions", ",", "positions1D"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856285059561145*^9, 3.856285066835868*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"2daae466-90bd-4d57-9548-30b6c2081c5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eventsList", "[", "digits_", "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{"Most", "[", 
    RowBox[{"FixedPointList", "[", 
     RowBox[{"bounceParticlesAtShortestCollision", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"N", "[", 
         RowBox[{"particleStates", "[", "digits", "]"}], "]"}]}], "}"}]}], 
     "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856285550052911*^9, 3.856285573251648*^9}, {
  3.856285754417004*^9, 3.856285761621914*^9}, {3.85630165377989*^9, 
  3.856301662042334*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"ad56193e-22b7-4da8-8d82-f241e416205d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440., 850.5},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"10e9de80-66b2-4b73-a25d-d1b49d406ddb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 192, 3, 83, "Section",ExpressionUUID->"e3540a38-8e28-4737-a164-548e4141c713"],
Cell[CellGroupData[{
Cell[797, 29, 169, 3, 40, "Item",ExpressionUUID->"337dd60c-4f7d-4ee3-9e44-5687c1bef94b"],
Cell[969, 34, 188, 3, 34, "Subitem",ExpressionUUID->"04497284-e671-4c50-bea3-b55fe418a37f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1194, 42, 249, 6, 40, "Item",ExpressionUUID->"756c4a52-7754-4ca2-9f5b-79aaacef5cc8"],
Cell[1446, 50, 247, 6, 34, "Subitem",ExpressionUUID->"81ea7a02-6569-45c3-8651-c22c016d75ad"],
Cell[1696, 58, 199, 3, 34, "Subitem",ExpressionUUID->"21bffb01-a3de-4639-bf44-bf7f047102ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1932, 66, 344, 7, 40, "Item",ExpressionUUID->"42e2a116-a18b-49ca-9597-c5100a9a97c6"],
Cell[CellGroupData[{
Cell[2301, 77, 745, 22, 38, "Subitem",ExpressionUUID->"1b9c48fa-8259-45da-8df4-632a7c8e77a1"],
Cell[CellGroupData[{
Cell[3071, 103, 1966, 57, 225, "Input",ExpressionUUID->"91cfcbec-67ed-4f87-8c1e-3de2fe4514e3"],
Cell[5040, 162, 1591, 47, 60, "Output",ExpressionUUID->"af13c981-c30f-4009-ba5d-815bbe2e9957"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6680, 215, 234, 6, 34, "Subitem",ExpressionUUID->"1b34a141-cab5-4121-8a51-7c825592452e"],
Cell[6917, 223, 6323, 151, 930, "Input",ExpressionUUID->"9d22f2c8-6811-436b-8d93-7f42915ee273"],
Cell[CellGroupData[{
Cell[13265, 378, 337, 6, 36, "Input",ExpressionUUID->"a46c8b84-4362-47ee-804b-c68f0a2a1bf0"],
Cell[13605, 386, 131, 3, 32, "Echo",ExpressionUUID->"fb276bcc-c1ce-4a0b-9548-d604f8248521"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13797, 396, 224, 4, 40, "Item",ExpressionUUID->"32e55dc2-dd4c-470c-b1af-7db96d42ecf0"],
Cell[14024, 402, 2730, 56, 341, "Input",ExpressionUUID->"dc8d6c93-f4f7-40aa-9ece-d3359fa6b88b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16803, 464, 164, 3, 83, "Section",ExpressionUUID->"5d5cc657-42b2-4c8c-b470-d6a0208b6d28"],
Cell[CellGroupData[{
Cell[16992, 471, 167, 3, 68, "Subsection",ExpressionUUID->"e66832d3-9345-47d4-8e87-9b914aa5ed9a"],
Cell[CellGroupData[{
Cell[17184, 478, 218, 4, 40, "Item",ExpressionUUID->"01eea97e-2a49-4bd5-bb3c-a336d5c7768a"],
Cell[CellGroupData[{
Cell[17427, 486, 283, 9, 34, "Subitem",ExpressionUUID->"c58faefd-29a0-4a38-9d61-2cb3c850315e"],
Cell[17713, 497, 648, 16, 62, "Input",ExpressionUUID->"0fc2b71c-7ec0-43f1-9196-8c1c7dd5cf76"],
Cell[CellGroupData[{
Cell[18386, 517, 399, 9, 36, "Input",ExpressionUUID->"8c0229ba-1b09-4bcc-a891-8f3f1a579f2b"],
Cell[18788, 528, 448, 12, 41, "Output",ExpressionUUID->"a5d0cca1-d3c8-4bc5-88cb-5ada5e209cf8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19285, 546, 298, 7, 34, "Subitem",ExpressionUUID->"c31b5121-af9a-4b97-a8a9-4c07d119affd"],
Cell[CellGroupData[{
Cell[19608, 557, 158, 2, 36, "Input",ExpressionUUID->"ba9523da-2e62-428a-9e85-f4ce3afddd34"],
Cell[19769, 561, 602, 16, 41, "Output",ExpressionUUID->"5fe3c867-71f7-412a-8a46-dc53de3dbbe0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20408, 582, 1525, 38, 164, "Input",ExpressionUUID->"6ce56261-f40c-4133-bcfc-8508f472fbb8"],
Cell[21936, 622, 570, 11, 41, "Output",ExpressionUUID->"199b6d53-6870-40f7-a0e9-ecd2bcb36d45"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22543, 638, 535, 14, 36, "Input",ExpressionUUID->"3d899bba-1317-4601-8252-4dea89c77349"],
Cell[23081, 654, 1540, 44, 68, "Output",ExpressionUUID->"0c27acff-c49c-4c92-82ab-bf3629bb5876"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24682, 705, 299, 4, 40, "Item",ExpressionUUID->"1a12604b-4451-4ee6-8e8d-dfa1a232a102"],
Cell[CellGroupData[{
Cell[25006, 713, 326, 5, 34, "Subitem",ExpressionUUID->"d9bb1445-4c88-4b9d-b372-6037dae655c1"],
Cell[CellGroupData[{
Cell[25357, 722, 665, 17, 39, "Input",ExpressionUUID->"cfb6d6cd-88a7-4846-ad69-76f67ad5ffa8"],
Cell[26025, 741, 508, 13, 41, "Output",ExpressionUUID->"a0a8be7a-4ad2-48b9-b003-d0cc295c3bb2"]
}, Open  ]],
Cell[26548, 757, 2761, 65, 462, "Input",ExpressionUUID->"a6968cf7-73a6-4d9d-a38d-36c45d4265e0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[29346, 827, 166, 3, 34, "Subitem",ExpressionUUID->"b6aff870-fa63-46e3-926c-b311301663fa"],
Cell[CellGroupData[{
Cell[29537, 834, 801, 19, 113, "Input",ExpressionUUID->"08c1cf9c-c978-4994-a3a8-412a55b18a2c"],
Cell[30341, 855, 293, 5, 41, "Output",ExpressionUUID->"0135a6c9-3f25-4a38-96b5-8ff3158968cd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30683, 866, 184, 3, 34, "Subitem",ExpressionUUID->"4cbd1d5b-76d7-42ef-8acd-966ad0612aca"],
Cell[CellGroupData[{
Cell[30892, 873, 814, 21, 113, "Input",ExpressionUUID->"05d485ff-df93-4da1-ae16-b210a0d05332"],
Cell[31709, 896, 301, 5, 56, "Output",ExpressionUUID->"9e41f875-9cd1-41b1-b6f4-355866c1e802"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32071, 908, 239, 6, 40, "Item",ExpressionUUID->"b6dc93f0-001d-4232-885a-bebe504fe44f"],
Cell[32313, 916, 567, 15, 56, "Input",ExpressionUUID->"b433d2f0-7ff2-47f5-a277-0ada65de98c4",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32929, 937, 173, 3, 68, "Subsection",ExpressionUUID->"7e14c8ce-117e-4c45-995e-4cf9a15fd42c"],
Cell[33105, 942, 231, 6, 40, "Item",ExpressionUUID->"ece95725-a3e3-4917-a054-9f39993cb23f"],
Cell[CellGroupData[{
Cell[33361, 952, 194, 4, 40, "Item",ExpressionUUID->"6bcbfd7b-992c-44ca-b680-a761ab00edd3"],
Cell[CellGroupData[{
Cell[33580, 960, 1808, 54, 174, "Input",ExpressionUUID->"8417ddc5-9cbe-4567-80d5-8f741ed4d6f0"],
Cell[35391, 1016, 1591, 47, 60, "Output",ExpressionUUID->"f8d825df-5a6f-4472-9130-025ae9b14ba1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37031, 1069, 217, 4, 40, "Item",ExpressionUUID->"39a9d2f0-2eb7-4505-97c4-bb1cd0eff331"],
Cell[37251, 1075, 2144, 57, 329, "Input",ExpressionUUID->"ebe75040-4d2a-4dc6-80ff-c8bea3df6470",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[39420, 1136, 306, 6, 34, "Subitem",ExpressionUUID->"9c58ec86-2d9d-4951-8baf-a95f554e1bc6"],
Cell[39729, 1144, 2955, 82, 537, "Input",ExpressionUUID->"1fa6d5a6-1461-4355-837f-e2f8192f9659",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42745, 1233, 202, 4, 68, "Subsection",ExpressionUUID->"20c4429b-a8ca-4f03-89a9-c8b86c0a585d"],
Cell[CellGroupData[{
Cell[42972, 1241, 154, 3, 40, "Item",ExpressionUUID->"78deaaed-f117-4381-9e5e-ff529b4229ba"],
Cell[43129, 1246, 246, 4, 34, "Subitem",ExpressionUUID->"7f9e497f-a60a-4946-b627-726b6c0c1bf5"],
Cell[43378, 1252, 179, 3, 34, "Subitem",ExpressionUUID->"182bd1f0-b22b-4442-b362-e1c0675954c7"],
Cell[CellGroupData[{
Cell[43582, 1259, 451, 12, 34, "Subitem",ExpressionUUID->"ad82173d-a49d-4072-a7b6-c47bf94c67e1"],
Cell[44036, 1273, 1158, 29, 165, "Input",ExpressionUUID->"d2f54025-dc63-4054-91d6-2ac02b9b86d5",
 InitializationCell->True],
Cell[45197, 1304, 2847, 82, 189, "Input",ExpressionUUID->"29122662-4de0-4945-9845-5b61fc3c9859"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48093, 1392, 194, 3, 40, "Item",ExpressionUUID->"a1b92e4f-ed47-465f-bb78-0c4d406acc1e"],
Cell[48290, 1397, 179, 3, 34, "Subitem",ExpressionUUID->"6e03976a-e4fd-41d5-a94b-7d217dcfb9cd"],
Cell[48472, 1402, 184, 3, 34, "Subitem",ExpressionUUID->"0d7ff374-62b0-4712-b41d-fa4fe55af02b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48693, 1410, 196, 3, 40, "Item",ExpressionUUID->"8581feac-143c-4220-b276-0160c8a8d886"],
Cell[48892, 1415, 167, 3, 34, "Subitem",ExpressionUUID->"e1247a19-b46b-4549-b03a-447c6d19074d"],
Cell[49062, 1420, 176, 3, 34, "Subitem",ExpressionUUID->"c17dcefd-b1da-493d-a42c-4860ca6f19a0"],
Cell[CellGroupData[{
Cell[49263, 1427, 161, 3, 34, "Subitem",ExpressionUUID->"a313e9b8-5849-4c2f-9565-a3dd4f083afe"],
Cell[49427, 1432, 3990, 103, 538, "Input",ExpressionUUID->"d2d61eb8-f8d9-448e-a097-f98ac2e42715",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53478, 1542, 171, 3, 68, "Subsection",ExpressionUUID->"bab57217-7c89-4de5-83e3-cbb29b430902"],
Cell[53652, 1547, 3556, 95, 234, "Input",ExpressionUUID->"80bb15a1-847b-46fe-88f4-242228475d73",
 InitializationCell->True],
Cell[57211, 1644, 1241, 32, 138, "Input",ExpressionUUID->"2daae466-90bd-4d57-9548-30b6c2081c5f",
 InitializationCell->True],
Cell[58455, 1678, 672, 16, 56, "Input",ExpressionUUID->"ad56193e-22b7-4da8-8d82-f241e416205d",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

