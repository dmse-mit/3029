(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    150024,       3396]
NotebookOptionsPosition[    140465,       3214]
NotebookOutlinePosition[    140862,       3230]
CellTagsIndexPosition[    140819,       3227]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Initial code to do step wise polymerization simulations.  14 Feb. 2022\
\>", "Section",
 CellChangeTimes->{
  3.853155165793206*^9, {3.853853756892929*^9, 
   3.853853757286242*^9}},ExpressionUUID->"4859a45a-a556-441d-9860-\
1655e4c4980a"],

Cell["\<\

Periodic?

Continuous Feed?\
\>", "Section",
 CellChangeTimes->{{3.853155169243084*^9, 3.853155288384288*^9}, {
  3.85385376801825*^9, 
  3.853853768153192*^9}},ExpressionUUID->"13014e8c-0b8f-4b45-82e5-\
a22c9ee8d605"],

Cell[CellGroupData[{

Cell["Simulation of Step-Wise Polymerization", "Chapter",
 CellChangeTimes->{{3.853584061235525*^9, 
  3.8535840776176434`*^9}},ExpressionUUID->"aa788034-b1b7-4089-beb6-\
45e7017f573d"],

Cell[CellGroupData[{

Cell[TextData[{
 "The simulation begins with \[OpenCurlyDoubleQuote]unreacted\
\[CloseCurlyDoubleQuote] particles  ",
 Cell[BoxData[
  GraphicsBox[{
    {RGBColor[1, 0, 0], 
     DiskBox[{3.7827200470790134, 1.3614176948128998}, 0.5], 
     DiskBox[{0.03625053968815961, -9.099290657264635}, 0.5], 
     DiskBox[{-11.611658911494782, -7.292763238136324}, 0.5], 
     DiskBox[{11.905184082498382, 0.19759958836889635}, 0.5], 
     DiskBox[{6.848609261361754, 7.514692704237702}, 0.5], 
     DiskBox[{-12.108277032168441, -4.997791968957321}, 0.5], 
     DiskBox[{-9.297086290009043, -2.448006493367222}, 0.5], 
     DiskBox[{-1.1082325890366285, -1.9509229537941986}, 0.5], 
     DiskBox[{6.522649353174375, -0.37551599403832236}, 0.5], 
     DiskBox[{-12.34010723456181, -11.568572033024655}, 0.5], 
     DiskBox[{-0.3002635419234789, -4.094904518324799}, 0.5], 
     DiskBox[{-7.0114082038431835, 3.4915189481550812}, 0.5], 
     DiskBox[{12.401133385392377, -11.811488832221128}, 0.5], 
     DiskBox[{-8.222537249820371, -4.6800096235786075}, 0.5], 
     DiskBox[{-10.196634948787775, -5.618407810506543}, 0.5], 
     DiskBox[{-2.6282374302703415, 6.72459058563713}, 0.5], 
     DiskBox[{-7.004356134826267, -2.3886496435801763}, 0.5], 
     DiskBox[{8.938439202366288, -10.583242607401317}, 0.5], 
     DiskBox[{8.740125097319257, 11.904254131540265}, 0.5], 
     DiskBox[{6.5693934699475705, -3.070487035437125}, 0.5], 
     DiskBox[{2.1321363424172066, -12.277576126417555}, 0.5], 
     DiskBox[{0.61956406760309, 9.628546372815533}, 0.5], 
     DiskBox[{-9.52955679610366, 9.42142844893788}, 0.5], 
     DiskBox[{2.1431394062895293, 8.12731071386713}, 0.5], 
     DiskBox[{-4.740558268281053, -1.4475932891502563}, 0.5], 
     DiskBox[{8.105656374840148, 2.7469072139852333}, 0.5], 
     DiskBox[{-2.056193627395142, 0.7789453382876621}, 0.5], 
     DiskBox[{5.802073130076025, -8.98293330107628}, 0.5], 
     DiskBox[{11.219119384240466, -2.3412459749596213}, 0.5], 
     DiskBox[{11.260041547157046, 11.257067263520687}, 0.5], 
     DiskBox[{0.5043706550610039, 4.938351136111257}, 0.5], 
     DiskBox[{-9.247735516519418, 3.736291305246253}, 0.5], 
     DiskBox[{0.03837248570949803, -0.25038127343904315}, 0.5], 
     DiskBox[{-5.3544309712501015, -9.71826141736819}, 0.5], 
     DiskBox[{8.892065164831708, 6.216321720955515}, 0.5], 
     DiskBox[{4.812649456202362, 8.555305488555764}, 0.5], 
     DiskBox[{5.871253085333788, 2.5672603416012296}, 0.5], 
     DiskBox[{12.298795598515838, 5.149475587041263}, 0.5], 
     DiskBox[{-6.028914733962232, -4.243253599339292}, 0.5], 
     DiskBox[{12.311368929707289, 8.82888670906058}, 0.5], 
     DiskBox[{-6.369601731273933, -7.136669302491599}, 0.5], 
     DiskBox[{-3.4413588539546125, -11.486032178446532}, 0.5], 
     DiskBox[{-3.941143443322437, 2.231663535669326}, 0.5], 
     DiskBox[{-7.847761719826463, 12.290531788757232}, 0.5], 
     DiskBox[{-2.0900420673045375, -9.773937419254247}, 0.5], 
     DiskBox[{11.857036122870223, 2.2085573188072027}, 0.5], 
     DiskBox[{8.606654085642102, -1.2440296363985914}, 0.5], 
     DiskBox[{-9.060106978831007, 0.22084003553370368}, 0.5], 
     DiskBox[{-9.723134452570864, -8.331655993427617}, 0.5], 
     DiskBox[{7.484737124315383, -4.850568784073738}, 0.5], 
     DiskBox[{-0.12841892882984873, 2.6293720091907504}, 0.5], 
     DiskBox[{-7.779850634284314, 6.211662763276083}, 0.5], 
     DiskBox[{2.5309903243306286, 10.81468516895821}, 0.5], 
     DiskBox[{3.794337324936686, -4.1469371638269745}, 0.5], 
     DiskBox[{7.117617534102272, 4.870450396321169}, 0.5], 
     DiskBox[{-5.542794445212956, 7.961749285798797}, 0.5], 
     DiskBox[{-10.14308825483894, -10.748287192366451}, 0.5], 
     DiskBox[{6.763271756914207, 11.493727699762058}, 0.5], 
     DiskBox[{5.475703417493488, -5.542128178427852}, 0.5], 
     DiskBox[{1.828697086699943, -4.657710415039057}, 0.5], 
     DiskBox[{6.499309782280766, -11.852177873698283}, 0.5], 
     DiskBox[{2.8569382482953545, -8.564996182625045}, 0.5], 
     DiskBox[{4.758560547320501, 11.250772495832228}, 0.5], 
     DiskBox[{-11.749338274990627, 2.1091009763740507}, 0.5], 
     DiskBox[{3.9239583961127034, -6.811169369442604}, 0.5], 
     DiskBox[{9.089459584265436, 8.962901431366161}, 0.5], 
     DiskBox[{-12.011112121145961, 9.33049330436338}, 0.5], 
     DiskBox[{-1.9422383078360805, 4.678519905950795}, 0.5], 
     DiskBox[{3.732620056595082, 5.0509510265438315}, 0.5], 
     DiskBox[{-1.2301592252789595, -7.1968383295077825}, 0.5], 
     DiskBox[{-7.22556500410017, 9.592805223639555}, 0.5], 
     DiskBox[{-6.702512090290391, 1.4859826534708298}, 0.5], 
     DiskBox[{9.621390180767115, -4.668502350040099}, 0.5], 
     DiskBox[{11.656964796002923, -4.644468144439296}, 0.5], 
     DiskBox[{-12.437492133955264, 11.450504450078258}, 0.5], 
     DiskBox[{0.9784213340476744, -6.918287818178792}, 0.5], 
     DiskBox[{-3.617874042884006, -4.582839053206489}, 0.5], 
     DiskBox[{11.571552175169014, -6.841362922354382}, 0.5], 
     DiskBox[{-5.148465278548953, 4.4056791316059}, 0.5], 
     DiskBox[{-3.9607139884672513, 9.186932210942578}, 0.5], 
     DiskBox[{-3.7066542329394214, -6.711019677288721}, 0.5], 
     DiskBox[{1.8579275806788642, 2.312583681949704}, 0.5], 
     DiskBox[{9.650863004902682, 1.3860033410627137}, 0.5], 
     DiskBox[{11.176885941627573, 6.875786827987495}, 0.5], 
     DiskBox[{-0.5674245674899603, 7.5668133245963665}, 0.5], 
     DiskBox[{-10.464934038802598, 11.870297493395194}, 0.5], 
     DiskBox[{-11.358711210574441, 4.44903334352521}, 0.5], 
     DiskBox[{4.055144945991329, -10.574386609796582}, 0.5], 
     DiskBox[{-3.477998921246084, 11.579997998141062}, 0.5], 
     DiskBox[{0.7570776383796218, 11.943338847454804}, 0.5], 
     DiskBox[{2.150479832142854, -1.7282669783811322}, 0.5], 
     DiskBox[{9.08337326248978, -7.558546756633}, 0.5], 
     DiskBox[{-7.953031516436088, -11.107199158673692}, 0.5], 
     DiskBox[{11.690484874744843, -9.36804555120228}, 0.5], 
     DiskBox[{-7.41100526660341, -9.061801612217252}, 0.5], 
     DiskBox[{-11.275229553742028, 0.12973211064887247}, 0.5], 
     DiskBox[{10.190250284581264, 3.7551909098134773}, 0.5], 
     DiskBox[{-1.5503493373547061, -12.377850328817807}, 0.5], 
     DiskBox[{-11.39826786026239, 7.199342158403216}, 0.5]}, 
    {RGBColor[1, 0.5, 0]}, 
    {RGBColor[0, 0, 1]}},
   Background->RGBColor[0.87, 0.94, 1],
   ImageSize->{103.48750000000058`, Automatic},
   PlotRange->{{-13., 13.}, {-13., 13.}},
   Ticks->None]],
  CellChangeTimes->{{3.853584918108182*^9, 3.8535849360299597`*^9}, 
    3.8535850276864767`*^9, {3.853585174342556*^9, 3.853585197595265*^9}, {
    3.8535852792552032`*^9, 3.853585337195964*^9}},ExpressionUUID->
  "30cb05fb-687c-43fc-8305-e7c3dbd13e8a"],
 " represented by the red disks and constrained to stay in the square.\nThe \
particles move by random walk.\nIf two unreacted particles collide they \
react: ",
 Cell[BoxData[
  GraphicsBox[{
    {RGBColor[1, 0, 0], 
     DiskBox[{3.0032474450021582, 1.0415599187221982}, 0.5], 
     DiskBox[{-0.048578117518663366, -9.210399694997252}, 0.5], 
     DiskBox[{-11.6319551743143, -7.0587075865659985}, 0.5], 
     DiskBox[{11.453749318487434, 0.34004329992971943}, 0.5], 
     DiskBox[{6.265599261498959, 7.387935913406353}, 0.5], 
     DiskBox[{-12.5, -5.047466212794956}, 0.5], 
     DiskBox[{-8.981967017608426, -2.005691712190626}, 0.5], 
     DiskBox[{-1.1489348018407222, -2.0660320191329182}, 0.5], 
     DiskBox[{5.983663116015014, -0.6171162593912302}, 0.5], 
     DiskBox[{-12.328372818755689, -11.553373049445081}, 0.5], 
     DiskBox[{-0.36651610947811464, -3.665037782947824}, 0.5], 
     DiskBox[{-7.075082978262094, 3.544215441604677}, 0.5], 
     DiskBox[{12.5, -12.129706574255433}, 0.5], 
     DiskBox[{-8.014311537637703, -4.453819444816407}, 0.5], 
     DiskBox[{-10.383252020034082, -6.269300708281546}, 0.5], 
     DiskBox[{-3.370269728071104, 6.851367371886274}, 0.5], 
     DiskBox[{-6.730000171689945, -2.514923536028164}, 0.5], 
     DiskBox[{8.803508816638722, -10.52211423058208}, 0.5], 
     DiskBox[{9.024346264575511, 11.855805799862656}, 0.5], 
     DiskBox[{6.546501683980575, -3.2463333752506465}, 0.5], 
     DiskBox[{1.73449955435085, -12.049930733405967}, 0.5], 
     DiskBox[{0.3902861711041898, 9.424647239441574}, 0.5], 
     DiskBox[{-9.821275235259842, 9.4251694347443}, 0.5], 
     DiskBox[{2.2095998978974385, 8.09187016978648}, 0.5], 
     DiskBox[{-4.507548052159045, -1.0675819298300093}, 0.5], 
     DiskBox[{8.273865556844184, 2.9429087454144307}, 0.5], 
     DiskBox[{-1.8313776905771715, 1.185454531502064}, 0.5], 
     DiskBox[{6.200655950409606, -9.163142104484733}, 0.5], 
     DiskBox[{10.893227574467934, -2.4664923967819874}, 0.5], 
     DiskBox[{10.936580727463472, 11.06063734610834}, 0.5], 
     DiskBox[{0.19488900636305762, 5.109700624340242}, 0.5], 
     DiskBox[{-9.144334089657526, 3.8801738356843223}, 0.5], 
     DiskBox[{0.4001377763761899, 0.3387285331253249}, 0.5], 
     DiskBox[{-4.8738825656001765, -9.845280668611304}, 0.5], 
     DiskBox[{9.457095112062714, 5.672283475696302}, 0.5], 
     DiskBox[{4.7584653718522905, 8.361928790757199}, 0.5], 
     DiskBox[{6.275924852654784, 1.8987291271207738}, 0.5], 
     DiskBox[{12.5, 4.906663019044314}, 0.5], 
     DiskBox[{-5.8466366760197745, -4.333195414579432}, 0.5], 
     DiskBox[{12.185520501904623, 8.710710284648469}, 0.5], 
     DiskBox[{-6.052827234042477, -7.4840672131293555}, 0.5], 
     DiskBox[{-3.9371151416959647, -11.362299238182864}, 0.5], 
     DiskBox[{-3.7871563445336, 1.9778842718288656}, 0.5], 
     DiskBox[{-7.792950453838193, 12.5}, 0.5], 
     DiskBox[{-1.580068549811149, -9.822364911203964}, 0.5], 
     DiskBox[{11.711127795259724, 1.9379232420619057}, 0.5], 
     DiskBox[{8.341333758029643, -1.2644885548170939}, 0.5], 
     DiskBox[{-9.413686388643985, 0.6598511877078223}, 0.5], 
     DiskBox[{-9.148994778036746, -8.600348495097805}, 0.5], 
     DiskBox[{7.51836575078706, -4.716050915444351}, 0.5], 
     DiskBox[{-0.3138827069459601, 2.270461157143241}, 0.5], 
     DiskBox[{-7.484606863897831, 6.223156183865996}, 0.5], 
     DiskBox[{2.1164907018373023, 10.879688726584979}, 0.5], 
     DiskBox[{4.0585267009661985, -3.8707853391027043}, 0.5], 
     DiskBox[{7.111115157077074, 4.820487823982435}, 0.5], 
     DiskBox[{-10.270706954759179, -10.867845136238069}, 0.5], 
     DiskBox[{6.798710954968264, 11.700913569885767}, 0.5], 
     DiskBox[{5.097737005447969, -5.191425080062834}, 0.5], 
     DiskBox[{1.690016109297445, -4.91165742164524}, 0.5], 
     DiskBox[{5.73193373490442, -12.141436113091578}, 0.5], 
     DiskBox[{2.863159717233753, -8.84072527704044}, 0.5], 
     DiskBox[{4.987754383787305, 10.98208145706759}, 0.5], 
     DiskBox[{-11.820157064823407, 2.704948439829072}, 0.5], 
     DiskBox[{3.7189628687653147, -7.431425140485959}, 0.5], 
     DiskBox[{9.236479946477013, 9.214016806325393}, 0.5], 
     DiskBox[{-12.204947565004513, 9.3616531187776}, 0.5], 
     DiskBox[{-1.8903098509125653, 4.915967925855394}, 0.5], 
     DiskBox[{3.9235176081761414, 5.317176066340652}, 0.5], 
     DiskBox[{-0.9080452654948351, -6.887835492030219}, 0.5], 
     DiskBox[{-7.343310252707555, 9.51972255235453}, 0.5], 
     DiskBox[{-6.292593740186414, 1.286582286736683}, 0.5], 
     DiskBox[{9.823997756078775, -4.789522505569624}, 0.5], 
     DiskBox[{11.894584097481962, -4.950895724311196}, 0.5], 
     DiskBox[{-11.874317035835976, 11.3537817847985}, 0.5], 
     DiskBox[{1.2720125910897715, -7.710613296724048}, 0.5], 
     DiskBox[{-2.9517917718955067, -4.788733582534541}, 0.5], 
     DiskBox[{11.839411880060315, -7.330950921973623}, 0.5], 
     DiskBox[{-5.181358580480155, 3.6567374487472475}, 0.5], 
     DiskBox[{-3.4884196801130076, -6.960007056185415}, 0.5], 
     DiskBox[{1.948462337417441, 2.53114337838728}, 0.5], 
     DiskBox[{9.102574486537863, 1.1050112115387107}, 0.5], 
     DiskBox[{11.446493982206613, 6.841376460227667}, 0.5], 
     DiskBox[{0.08957721085157347, 7.783836877432529}, 0.5], 
     DiskBox[{-10.256129479551507, 11.99859599879139}, 0.5], 
     DiskBox[{-10.953502567918203, 4.275170901554706}, 0.5], 
     DiskBox[{4.301435182943847, -10.28198143498525}, 0.5], 
     DiskBox[{-3.242045698999538, 11.42778817297971}, 0.5], 
     DiskBox[{0.6737170618140782, 11.51994884813823}, 0.5], 
     DiskBox[{2.447429898825758, -1.5890883227325203}, 0.5], 
     DiskBox[{8.749662868535498, -7.595963069810128}, 0.5], 
     DiskBox[{-7.894854376176413, -11.217175796602874}, 0.5], 
     DiskBox[{11.490519660981358, -9.750197143094917}, 0.5], 
     DiskBox[{-7.869997583070127, -8.956649125066875}, 0.5], 
     DiskBox[{-11.244298490709035, 0.004541919991404408}, 0.5], 
     DiskBox[{10.065256795089589, 3.56332216734256}, 0.5], 
     DiskBox[{-1.0778930715579287, -12.17832188183069}, 0.5], 
     DiskBox[{-11.223793516454064, 6.879956927662481}, 0.5]}, 
    {RGBColor[1, 0.5, 0], 
     DiskBox[{-5.200307885531949, 8.296622248726512}, 0.5], 
     DiskBox[{-4.608492883892163, 9.06968040906855}, 0.5]}, 
    {RGBColor[0, 0, 1]}},
   Background->RGBColor[0.87, 0.94, 1],
   ImageSize->{118.86875000000765`, Automatic},
   PlotRange->{{-13., 13.}, {-13., 13.}},
   Ticks->None]],
  CellChangeTimes->{{3.853584918108182*^9, 3.8535849360299597`*^9}, 
    3.8535850276864767`*^9, {3.853585174342556*^9, 3.853585197595265*^9}, {
    3.8535852792552032`*^9, 3.853585337195964*^9}},ExpressionUUID->
  "c7d1d7dd-c76c-44ea-a350-f8bcb98ba67a"],
 " and are indicated by orange disks. Two touching orange disks represent a \
dimer.\n\nThe unreacted particles continue their random walk and to form \
dimers. If one of the active particles collides with yellow (terminating) \
particle, it reacts and becomes the new terminating particle. The previously \
terminating particle becomes inert and is indicated by an blue disk: ",
 Cell[BoxData[
  GraphicsBox[{
    {RGBColor[1, 0, 0], 
     DiskBox[{-11.561306733203194, -5.339002341329232}, 0.5], 
     DiskBox[{10.182407056549026, -8.702234386652304}, 0.5], 
     DiskBox[{8.065957264386405, 3.1397655332252636}, 0.5], 
     DiskBox[{-11.2756277452772, -2.9238632629865284}, 0.5], 
     DiskBox[{-8.570116848633276, -11.66556350473771}, 0.5], 
     DiskBox[{-10.477331215295449, 1.121931300396086}, 0.5], 
     DiskBox[{10.491976893863523, -11.964722340187475}, 0.5], 
     DiskBox[{9.521309217813148, 9.287677586606694}, 0.5], 
     DiskBox[{9.634737878535216, 11.001099131953595}, 0.5], 
     DiskBox[{7.202248371003447, -5.534732587043878}, 0.5], 
     DiskBox[{6.4735091472382384, 11.108790979231355}, 0.5], 
     DiskBox[{11.896752445925154, -11.57376313765259}, 0.5], 
     DiskBox[{-12.198915559948261, -0.28618165921210087}, 0.5], 
     DiskBox[{4.666829504087219, 12.449334604485676}, 0.5], 
     DiskBox[{-7.581725059809971, -0.12317628941985576}, 0.5], 
     DiskBox[{-3.7036342025687174, -2.185617642533872}, 0.5], 
     DiskBox[{11.954478670059679, -10.132166644758215}, 0.5], 
     DiskBox[{12.149381234793468, 2.0288774947009047}, 0.5], 
     DiskBox[{-9.49671468481365, -10.52166132690462}, 0.5], 
     DiskBox[{9.475123451945743, -7.177857366082789}, 0.5], 
     DiskBox[{-9.066286950687873, -0.981422747179516}, 0.5], 
     DiskBox[{0.4426436695189039, -2.955513516992913}, 0.5], 
     DiskBox[{1.1554360283929157, -4.713848583736471}, 0.5], 
     DiskBox[{6.3662493532463005, 5.74445684829889}, 0.5], 
     DiskBox[{-6.990506717138628, 12.317675916033274}, 0.5], 
     DiskBox[{-1.7628390352458556, -11.564835531547939}, 0.5], 
     DiskBox[{7.086666207841142, 8.751016828942335}, 0.5], 
     DiskBox[{-9.374053172261156, -6.033296767204635}, 0.5], 
     DiskBox[{-2.8934062990206093, 10.292386141263565}, 0.5], 
     DiskBox[{11.56227624386353, 5.840850045544313}, 0.5], 
     DiskBox[{-7.72853130714373, 8.74318780125258}, 0.5], 
     DiskBox[{-12.222080314275892, 9.556446184592222}, 0.5], 
     DiskBox[{4.213098589550967, 8.295437607511328}, 0.5], 
     DiskBox[{-11.839805198194417, -11.428995913470631}, 0.5], 
     DiskBox[{0.9497610769117982, 7.803506996314894}, 0.5], 
     DiskBox[{4.004851578619822, -7.485379765889627}, 0.5], 
     DiskBox[{0.17432341730299847, 2.1571169533427357}, 0.5], 
     DiskBox[{-12.306819729674338, -8.61017206839571}, 0.5], 
     DiskBox[{11.355818423073048, -6.035994902475193}, 0.5], 
     DiskBox[{3.2155644952280324, -4.819128313362934}, 0.5], 
     DiskBox[{-0.22741725007395647, 9.093216571858056}, 0.5], 
     DiskBox[{-3.416433157027434, 3.425151994424823}, 0.5], 
     DiskBox[{-7.669984356152279, -6.263693445482254}, 0.5], 
     DiskBox[{0.2966937053529501, -10.102017342492653}, 0.5], 
     DiskBox[{-11.570321438955803, 6.539695022485466}, 0.5], 
     DiskBox[{-4.58447362278023, -11.947238156949325}, 0.5], 
     DiskBox[{11.380431014160273, 9.655495711338649}, 0.5]}, 
    {RGBColor[1, 0.5, 0], 
     DiskBox[{-11.631791492410327, 12.428679122362311}, 0.5], 
     DiskBox[{-10.679852518723907, 12.266984224673365}, 0.5], 
     DiskBox[{-9.78420340969799, 4.110533069770491}, 0.5], 
     DiskBox[{-8.839585064960076, 3.913967813704093}, 0.5], 
     DiskBox[{-7.889991700611121, 10.713891167548692}, 0.5], 
     DiskBox[{-7.632660174705241, -2.7911710470668054}, 0.5], 
     DiskBox[{-6.9129392814178825, 10.8861088827055}, 0.5], 
     DiskBox[{-6.665354107674458, -2.6930264928336687}, 0.5], 
     DiskBox[{-6.614390824637147, 1.6915350593317284}, 0.5], 
     DiskBox[{-6.349320809294811, -10.129224159948256}, 0.5], 
     DiskBox[{-6.019633959538571, -9.20084534940223}, 0.5], 
     DiskBox[{-5.618260004924448, 1.6637444778081014}, 0.5], 
     DiskBox[{-4.094362741963472, 6.6279678090111815}, 0.5], 
     DiskBox[{-3.7903990423043488, -8.193915092464957}, 0.5], 
     DiskBox[{-3.2523027022124134, 7.160261603435563}, 0.5], 
     DiskBox[{-3.049900157657505, -4.528031380472638}, 0.5], 
     DiskBox[{-2.858050517607222, -7.952081571842621}, 0.5], 
     DiskBox[{-2.1077464798728505, 1.3476969115931507}, 0.5], 
     DiskBox[{-2.0565650448611184, -4.535162299280427}, 0.5], 
     DiskBox[{-0.8367212134240051, 5.4071353259767605}, 0.5], 
     DiskBox[{-0.8306405927331845, -0.1451710191726027}, 0.5], 
     DiskBox[{0.14393338275256357, 5.602868138299513}, 0.5], 
     DiskBox[{0.6301841138148591, 10.963056583096437}, 0.5], 
     DiskBox[{1.120059228385278, 10.093548087469836}, 0.5], 
     DiskBox[{1.5984923946241658, -8.521268499487894}, 0.5], 
     DiskBox[{2.5895631480207966, -8.616428772361497}, 0.5], 
     DiskBox[{4.1918547123146075, 3.3164736551651846}, 0.5], 
     DiskBox[{4.587765192147667, 4.9576579813810895}, 0.5], 
     DiskBox[{5.060369163063627, -11.774195145149752}, 0.5], 
     DiskBox[{5.158152714007145, -10.508741667611051}, 0.5], 
     DiskBox[{5.213303512643791, -0.9377362057114702}, 0.5], 
     DiskBox[{5.437585367463302, 0.032156323588251545}, 0.5], 
     DiskBox[{6.034535824587942, -3.2283625344460205}, 0.5], 
     DiskBox[{7.020059795701489, -3.354872516339066}, 0.5], 
     DiskBox[{7.835159359096875, -8.89649317147311}, 0.5], 
     DiskBox[{8.09491173711847, -7.9609587538091295}, 0.5], 
     DiskBox[{10.213538701953745, 6.620380462465604}, 0.5], 
     DiskBox[{10.296437944407343, 2.737922698336344}, 0.5], 
     DiskBox[{10.764770913647173, 1.8873978236241724}, 0.5], 
     DiskBox[{10.89012250505776, 7.355293424466253}, 0.5], 
     DiskBox[{11.445021577384088, -2.7730410474417564}, 0.5], 
     DiskBox[{11.754528965406294, -1.8550473266914622}, 0.5]}, 
    {RGBColor[0, 0, 1], 
     DiskBox[{-1.569274107936075, 0.5260897832530516}, 0.5], 
     DiskBox[{4.877301351765144, 4.039996891713907}, 0.5], 
     DiskBox[{5.878527534421046, -11.202121403605506}, 0.5]}},
   Background->RGBColor[0.87, 0.94, 1],
   ImageSize->{141.41874999999982`, Automatic},
   PlotRange->{{-13., 13.}, {-13., 13.}},
   Ticks->None]],
  CellChangeTimes->{{3.853584918108182*^9, 3.8535849360299597`*^9}, 
    3.8535850276864767`*^9, {3.853585174342556*^9, 3.853585197595265*^9}, {
    3.8535852792552032`*^9, 3.853585337195964*^9}},ExpressionUUID->
  "5c3a4aea-25bf-47d1-90ad-673bd5e691c7"],
 " \nAnd the reactions proceed:  ",
 Cell[BoxData[
  GraphicsBox[{
    {RGBColor[1, 0, 0], 
     DiskBox[{-9.12622670548684, 8.77724222284034}, 0.5]}, 
    {RGBColor[1, 0.5, 0], 
     DiskBox[{-11.65363394889037, -1.6354137274903384}, 0.5], 
     DiskBox[{-11.631791492410327, 12.428679122362311}, 0.5], 
     DiskBox[{-11.059732495431993, -5.690244551671031}, 0.5], 
     DiskBox[{-10.691240654471144, -1.8646916484235514}, 0.5], 
     DiskBox[{-10.604920012564335, 11.285993802591616}, 0.5], 
     DiskBox[{-10.54459230463545, -10.675604655753643}, 0.5], 
     DiskBox[{-9.78420340969799, 4.110533069770491}, 0.5], 
     DiskBox[{-9.738695201734714, -6.920359238958861}, 0.5], 
     DiskBox[{-9.474393787719825, -0.6724672673754514}, 0.5], 
     DiskBox[{-8.839585064960076, 3.913967813704093}, 0.5], 
     DiskBox[{-8.77296887134897, -11.192611641763193}, 0.5], 
     DiskBox[{-7.889991700611121, 10.713891167548692}, 0.5], 
     DiskBox[{-7.797007828313138, -0.3376944516391625}, 0.5], 
     DiskBox[{-7.632660174705241, -2.7911710470668054}, 0.5], 
     DiskBox[{-7.344651865468708, 11.780747206924296}, 0.5], 
     DiskBox[{-6.665354107674458, -2.6930264928336687}, 0.5], 
     DiskBox[{-6.614390824637147, 1.6915350593317284}, 0.5], 
     DiskBox[{-6.349320809294811, -10.129224159948256}, 0.5], 
     DiskBox[{-6.019633959538571, -9.20084534940223}, 0.5], 
     DiskBox[{-5.618260004924448, 1.6637444778081014}, 0.5], 
     DiskBox[{-4.094362741963472, 6.6279678090111815}, 0.5], 
     DiskBox[{-3.878671543939324, -9.153756227264754}, 0.5], 
     DiskBox[{-3.303897267197931, 8.150451866492727}, 0.5], 
     DiskBox[{-3.049900157657505, -4.528031380472638}, 0.5], 
     DiskBox[{-2.858050517607222, -7.952081571842621}, 0.5], 
     DiskBox[{-2.161172531587005, 2.2261829276498317}, 0.5], 
     DiskBox[{-2.0565650448611184, -4.535162299280427}, 0.5], 
     DiskBox[{-0.9438847230423099, -1.1183848920209922}, 0.5], 
     DiskBox[{-0.8367212134240051, 5.4071353259767605}, 0.5], 
     DiskBox[{-0.3451868589658917, 8.938595769088025}, 0.5], 
     DiskBox[{0.14393338275256357, 5.602868138299513}, 0.5], 
     DiskBox[{0.22596632464878433, -2.7586162744183316}, 0.5], 
     DiskBox[{0.5010844607929944, -9.9184931654821}, 0.5], 
     DiskBox[{0.6301841138148591, 10.963056583096437}, 0.5], 
     DiskBox[{1.7771122138620057, -3.925666841680304}, 0.5], 
     DiskBox[{2.5895631480207966, -8.616428772361497}, 0.5], 
     DiskBox[{2.880132560947185, 8.492363885520673}, 0.5], 
     DiskBox[{3.711203143410874, 8.986853130840185}, 0.5], 
     DiskBox[{4.1918547123146075, 3.3164736551651846}, 0.5], 
     DiskBox[{4.587765192147667, 4.9576579813810895}, 0.5], 
     DiskBox[{5.060369163063627, -11.774195145149752}, 0.5], 
     DiskBox[{5.213303512643791, -0.9377362057114702}, 0.5], 
     DiskBox[{5.437585367463302, 0.032156323588251545}, 0.5], 
     DiskBox[{5.47933275202613, -9.590010757656344}, 0.5], 
     DiskBox[{6.034535824587942, -3.2283625344460205}, 0.5], 
     DiskBox[{6.5227447782337995, 2.802520006420132}, 0.5], 
     DiskBox[{6.635482767174965, 3.7721049342490307}, 0.5], 
     DiskBox[{7.020059795701489, -3.354872516339066}, 0.5], 
     DiskBox[{7.961579706765388, 10.420095680171164}, 0.5], 
     DiskBox[{8.123106614802133, -9.833716593255966}, 0.5], 
     DiskBox[{8.345174003447628, -7.033188936063544}, 0.5], 
     DiskBox[{10.29625852287323, -6.6249011645551725}, 0.5], 
     DiskBox[{10.296437944407343, 2.737922698336344}, 0.5], 
     DiskBox[{10.739405402280491, -5.728641058736522}, 0.5], 
     DiskBox[{10.89012250505776, 7.355293424466253}, 0.5], 
     DiskBox[{10.976166212276478, 9.457849661953247}, 0.5], 
     DiskBox[{11.042385759887672, 6.068036246135827}, 0.5], 
     DiskBox[{11.13825554812507, -10.794449126384059}, 0.5], 
     DiskBox[{11.445021577384088, -2.7730410474417564}, 0.5], 
     DiskBox[{11.701710661510207, 2.185199527319605}, 0.5], 
     DiskBox[{11.754528965406294, -1.8550473266914622}, 0.5], 
     DiskBox[{11.86873778601655, -11.914781952085942}, 0.5]}, 
    {RGBColor[0, 0, 1], 
     DiskBox[{-10.679852518723907, 12.266984224673365}, 0.5], 
     DiskBox[{-10.120963158678697, -5.941615487465914}, 0.5], 
     DiskBox[{-9.583886221847841, -10.615320777510192}, 0.5], 
     DiskBox[{-9.152999913127271, -6.151961284098243}, 0.5], 
     DiskBox[{-8.55081915585379, -0.9482466517761378}, 0.5], 
     DiskBox[{-6.9129392814178825, 10.8861088827055}, 0.5], 
     DiskBox[{-3.7903990423043488, -8.193915092464957}, 0.5], 
     DiskBox[{-3.2523027022124134, 7.160261603435563}, 0.5], 
     DiskBox[{-2.1077464798728505, 1.3476969115931507}, 0.5], 
     DiskBox[{-1.569274107936075, 0.5260897832530516}, 0.5], 
     DiskBox[{-1.1938125180517698, 1.6594419345510454}, 0.5], 
     DiskBox[{-0.8306405927331845, -0.1451710191726027}, 0.5], 
     DiskBox[{0.3740141429819933, 9.48347033245711}, 0.5], 
     DiskBox[{0.5235228111963169, 8.508760172312863}, 0.5], 
     DiskBox[{0.7185114910415908, -8.961984268531031}, 0.5], 
     DiskBox[{0.8737316920509073, -3.5156873453031374}, 0.5], 
     DiskBox[{1.120059228385278, 10.093548087469836}, 0.5], 
     DiskBox[{1.5984923946241658, -8.521268499487894}, 0.5], 
     DiskBox[{4.877301351765144, 4.039996891713907}, 0.5], 
     DiskBox[{5.158152714007145, -10.508741667611051}, 0.5], 
     DiskBox[{5.878527534421046, -11.202121403605506}, 0.5], 
     DiskBox[{7.835159359096875, -8.89649317147311}, 0.5], 
     DiskBox[{8.09491173711847, -7.9609587538091295}, 0.5], 
     DiskBox[{8.88402406744695, 10.126565850094975}, 0.5], 
     DiskBox[{9.755551381007436, 10.57310911022697}, 0.5], 
     DiskBox[{9.992476584302826, 9.63693314134469}, 0.5], 
     DiskBox[{10.213538701953745, 6.620380462465604}, 0.5], 
     DiskBox[{10.764770913647173, 1.8873978236241724}, 0.5], 
     DiskBox[{12.10767934394268, -10.96804281105654}, 0.5]}},
   Background->RGBColor[0.87, 0.94, 1],
   ImageSize->{142.850000000002, Automatic},
   PlotRange->{{-13., 13.}, {-13., 13.}},
   Ticks->None]],
  CellChangeTimes->{{3.853584918108182*^9, 3.8535849360299597`*^9}, 
    3.8535850276864767`*^9, {3.853585174342556*^9, 3.853585197595265*^9}, {
    3.8535852792552032`*^9, 3.853585337195964*^9}},ExpressionUUID->
  "db50c812-a064-4463-9654-527e03edf5b7"],
 "\n"
}], "Section",
 CellChangeTimes->{{3.853585721226582*^9, 3.853585865063489*^9}, {
  3.8535860409397984`*^9, 3.853586203684246*^9}, {3.85358623731173*^9, 
  3.853586265373764*^9}, {3.853586337644598*^9, 3.85358635876138*^9}, {
  3.85385111744342*^9, 3.8538511174441957`*^9}, {3.853851155200774*^9, 
  3.853851206204362*^9}, {3.853851281487526*^9, 3.853851354780304*^9}, {
  3.853851429459903*^9, 3.853851446120263*^9}, {3.853851477252585*^9, 
  3.8538514772531357`*^9}},ExpressionUUID->"8015691d-190d-499d-9c09-\
76e7f12242aa"],

Cell[CellGroupData[{

Cell["\<\
The simulation will be done in two- and three- dimensions.  We will use the \
language of two dimensions to describe the algorithm. 

The simulation begins with N disks representing particles constrained to a \
square with given side-length.\
\>", "Subsection",
 CellChangeTimes->{{3.8535840833342447`*^9, 3.8535842705745068`*^9}, {
  3.853584317622497*^9, 
  3.85358432900935*^9}},ExpressionUUID->"1d2a7260-8233-4a11-9ba4-\
3698cfab8a6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sideLength", " ", "=", " ", "20"}], ";"}]], "Input",
 CellChangeTimes->{{3.8531579856213007`*^9, 3.8531579920067453`*^9}, {
  3.853584276560918*^9, 3.853584278833015*^9}, {3.853584402737167*^9, 
  3.853584402776928*^9}, {3.853850504974169*^9, 3.853850506141131*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[1]:=",ExpressionUUID->"2aff80b9-404e-432f-973c-717f68601f91"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The particles are placed so that they don\[CloseCurlyQuote]t overlap.
We can use a Hard-Core Point Process\
\>", "Subsection",
 CellChangeTimes->{{3.8535843382508783`*^9, 3.853584371927788*^9}, {
  3.853584584269153*^9, 
  3.8535845984588337`*^9}},ExpressionUUID->"ceeb8904-1738-4de9-9b38-\
4bdf41857a3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"proc", "=", 
   RowBox[{"HardcorePointProcess", "[", 
    RowBox[{"1", ",", "4", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"proc", "=", 
     RowBox[{"HardcorePointProcess", "[", 
      RowBox[{"10", ",", "4", ",", "2"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"3", "D"}], "*)"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.8527187866943493`*^9, {3.852718890509068*^9, 3.852718890672132*^9}, {
   3.8528878696748343`*^9, 3.852887870263976*^9}, {3.852889532664887*^9, 
   3.852889548231*^9}, {3.853131589493806*^9, 3.8531316251074553`*^9}, {
   3.85313171856728*^9, 3.853131719889461*^9}, {3.8531317812658577`*^9, 
   3.853131816327731*^9}, {3.8531327980908117`*^9, 3.853132798197062*^9}, {
   3.85314966678754*^9, 3.853149674991735*^9}, {3.853149836970407*^9, 
   3.853149837270117*^9}, {3.853150186296794*^9, 3.8531501870973883`*^9}, {
   3.8531503055018387`*^9, 3.853150332713459*^9}, {3.8531503991051397`*^9, 
   3.853150400759012*^9}, 3.853150494226112*^9, {3.853157559955298*^9, 
   3.8531575604882517`*^9}, {3.85315813915548*^9, 3.8531581634780273`*^9}, {
   3.853158195187738*^9, 3.853158195564623*^9}, {3.8535843791719627`*^9, 
   3.853584386304508*^9}, {3.85358443560876*^9, 3.8535844390405416`*^9}, {
   3.853584543144823*^9, 3.853584543231165*^9}, {3.853584622368722*^9, 
   3.8535846224332113`*^9}, 3.853587541861071*^9},
 CellLabel->"2/14/22 21:28:17 (extra_kernel) In[2]:=",
 CellID->361480177,ExpressionUUID->"e3e13eaa-b10c-4e7c-b135-aa391d301a47"]
}, Open  ]],

Cell[CellGroupData[{

Cell["With a specified region", "Subsection",
 CellChangeTimes->{{3.853584603649036*^9, 
  3.8535846091016273`*^9}},ExpressionUUID->"a9a5b5a1-5314-4012-89e3-\
ffcf6c685038"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reg", " ", "=", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "sideLength"}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "/", "2"}]}], ",", 
     RowBox[{"sideLength", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "/", "2"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"reg", " ", "=", 
     RowBox[{"Cuboid", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "regionSize"}], 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "-"}], "}"}], "/", "2"}]}], ",", 
       RowBox[{"regionSize", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], "/", "2"}]}]}], "]"}]}], 
    ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"3", "D"}], "*)"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.85271879351155*^9, 3.852718823822916*^9}, {
  3.853131731031193*^9, 3.8531317713776217`*^9}, {3.853157563310543*^9, 
  3.853157618911821*^9}, {3.853157870899832*^9, 3.853157903186035*^9}, {
  3.8531579731772118`*^9, 3.853157998579973*^9}, {3.853584394226461*^9, 
  3.853584558817299*^9}},
 CellLabel->"2/14/22 21:28:17 (extra_kernel) In[3]:=",
 CellID->150792824,ExpressionUUID->"e829efaf-bf07-431a-ac43-ae9e6c8f50ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["For example:", "Subsection",
 CellChangeTimes->{{3.8535846131244183`*^9, 
  3.853584615601861*^9}},ExpressionUUID->"f148a25d-245b-4426-8f03-\
2fce85384a39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"particles", "=", 
   RowBox[{
    RowBox[{"RandomPointConfiguration", "[", 
     RowBox[{"proc", ",", "reg"}], "]"}], "[", "\"\<Points\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.8527188322553587`*^9, {3.8527189756387444`*^9, 3.85271898176375*^9}},
 CellLabel->"2/14/22 21:28:17 (extra_kernel) In[4]:=",
 CellID->32148238,ExpressionUUID->"543cafec-2a36-4ef6-bd75-022ea8e7a989"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Disk", "[", 
     RowBox[{"#", ",", 
      RowBox[{"1", "/", "2"}]}], "]"}], "&"}], "/@", "particles"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.85271884119398*^9, 3.8527188816777077`*^9}, {
  3.853157631513054*^9, 3.853157634634913*^9}, {3.853584571079138*^9, 
  3.8535845741221046`*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[5]:=",ExpressionUUID->"eafbe795-9b65-400d-8b77-5d33023868be"],

Cell[BoxData[
 GraphicsBox[{
   DiskBox[{5.741088889238037, 4.679203172453064}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{2.8866014529037898, 7.827176021205311}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{-9.832251549758011, 6.307092220190493}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{-0.7542255241939078, 9.875632103064591}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{4.672549934082166, -8.475288846778932}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{-4.1325348210193225, 6.137766145954804}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{0.46117307711006195, -8.708126271899971}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{8.867825810219374, 9.807030326595946}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{8.479208404898063, -5.306331150689174}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{-6.00818821373998, 1.6495930878234688}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{-8.734838464289911, -2.6732782789651965}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{-6.851819841351325, 9.704431223678473}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{-7.9513538589429045, -7.104829261231975}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{9.081574398068714, -9.378712904753339}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{0.06481762148021097, -4.620783381368909}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{2.9809443519035073, -1.5466314495548206}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{-2.1251369499094963, -0.2657219312280734}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{0.8575104530050659, 3.431679896855324}, NCache[
    Rational[1, 2], 0.5]], 
   DiskBox[{9.659730020200413, 2.7341029434649133}, NCache[
    Rational[1, 2], 0.5]]}]], "Output",
 CellChangeTimes->{3.8538592974944572`*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[5]=",ExpressionUUID->"a0cfb783-b07d-473e-8c9d-dbc4653f0f44"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We will keep track of the coordinates of three lists of particle types: \
active, terminating, and internal particles.  Here is a graphic function that \
will take those three lists and draw the picture.  The dimensionality of the \
graphics is determined by the dimensionality of the first particles \
coordinates.\
\>", "Subsection",
 CellChangeTimes->{{3.853586381966905*^9, 3.853586457123281*^9}, {
  3.8538537997977037`*^9, 
  3.853853839891485*^9}},ExpressionUUID->"471e86f1-70ad-4791-ac32-\
74450653b617"],

Cell[BoxData[
 RowBox[{
  RowBox[{"polymerGraphic", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "particles_", ",", "terminatingParticles_", ",", "internalParticles_"}], 
     "}"}], ",", " ", "sideLength_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dimensions", " ", "=", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"particles", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "nSphere", ",", 
      "plotRange", ",", " ", "graphics"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"dimensions", " ", "==", " ", "3"}], ",", " ", 
       RowBox[{
        RowBox[{"graphics", " ", "=", " ", "Graphics3D"}], ";", 
        RowBox[{"nSphere", " ", "=", " ", "Sphere"}], ";", " ", 
        RowBox[{"plotRange", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sideLength", "/", "2"}], "+", ".5"}], ")"}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dimensions", " ", "==", " ", "2"}], ",", 
       RowBox[{
        RowBox[{"graphics", " ", "=", " ", "Graphics"}], ";", 
        RowBox[{"nSphere", " ", "=", " ", "Disk"}], ";", " ", 
        RowBox[{"plotRange", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sideLength", "/", "2"}], "+", ".5"}], ")"}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], ",", 
       "\[IndentingNewLine]", "True", ",", "Nothing"}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"graphics", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Red", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"nSphere", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], "&"}], "/@", "particles"}], 
         ",", "\[IndentingNewLine]", "Orange", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"nSphere", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], "&"}], "/@", 
          "terminatingParticles"}], ",", "\[IndentingNewLine]", "Blue", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"nSphere", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], "&"}], "/@", 
          "internalParticles"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Opacity", "[", "0.25", "]"}], ","}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "->", "400"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Ticks", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "->", "plotRange"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.853584719634902*^9, 3.853584760825799*^9}, 
   3.853584826879747*^9, 3.8535857835882196`*^9, {3.853679653566351*^9, 
   3.853679660645576*^9}, {3.8537330400038958`*^9, 3.85373304596387*^9}, {
   3.85373307957755*^9, 3.853733079926325*^9}, {3.85384900721163*^9, 
   3.853849032049081*^9}, {3.853849072421166*^9, 3.853849072815366*^9}, {
   3.853850616596434*^9, 3.853850616837091*^9}, {3.8538512379119177`*^9, 
   3.8538512491359653`*^9}, {3.853851589860758*^9, 3.853851615082128*^9}, {
   3.853851651290552*^9, 3.853851872276066*^9}, {3.853851926787451*^9, 
   3.853851927531122*^9}, {3.8538519624444427`*^9, 3.853851985664839*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[6]:=",ExpressionUUID->"f85d1bb9-0cc6-442e-9971-3b78c5689402"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two Isolated Particles Combining to Form a Dimer", "Section",
 CellChangeTimes->{{3.853587375074683*^9, 
  3.8535873914799347`*^9}},ExpressionUUID->"197c1b0b-a8ac-48d6-b901-\
20fb3f01c092"],

Cell[CellGroupData[{

Cell["Suppose we have a list of active particles:", "Subsection",
 CellChangeTimes->{{3.853587419622208*^9, 
  3.85358742837888*^9}},ExpressionUUID->"3a49a317-f517-4dc0-b0a7-\
52e44e9a20ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"activePs", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".52"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{".52", ",", "0"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RandomSample", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"sideLength", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "/", "2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"12", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "#", "]"}], ">", "6"}], "&"}]}], "]"}], ",", 
       "3"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.853587438708972*^9, 3.853587495329743*^9}, {
  3.853587596681219*^9, 3.85358762779078*^9}, {3.853587663641089*^9, 
  3.85358773172758*^9}, {3.853588101716875*^9, 3.8535881426222143`*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[7]:=",ExpressionUUID->"8f871d13-d929-492e-94ec-4b643e0afb5a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polymerGraphic", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"activePs", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}], ",", "sideLength"}], "]"}]], "Input",
 CellChangeTimes->{{3.8535876401293583`*^9, 3.8535876524874268`*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[8]:=",ExpressionUUID->"d63aef78-db0e-4645-b468-adfd6ba781c7"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[1, 0, 0], DiskBox[{-0.52, 0}, NCache[Rational[1, 2], 0.5]], 
    DiskBox[{0.52, 0}, NCache[Rational[1, 2], 0.5]], 
    DiskBox[{-5.643867321622093, 8.510701972502936}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{6.278535134328614, 5.960560447186062}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{9.470947179735148, 7.858394944673499}, NCache[
     Rational[1, 2], 0.5]]}, 
   {RGBColor[1, 0.5, 0]}, 
   {RGBColor[0, 0, 1]}},
  Background->RGBColor[0.87, 0.94, 1],
  ImageSize->400,
  PlotRange->{{-10.5, 10.5}, {-10.5, 10.5}},
  Ticks->None]], "Output",
 CellChangeTimes->{3.853859297511278*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[8]=",ExpressionUUID->"0a780998-a202-4d5a-9a67-3204993497a1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We want the particles that are \[OpenCurlyDoubleQuote]close enough\
\[CloseCurlyDoubleQuote] to react and keep track of them so that we can add \
them to the terminating-particles list.  When they react, their positions \
will be adjusted so that they are touching.\
\>", "Subsection",
 CellChangeTimes->{{3.853587419622208*^9, 3.85358742837888*^9}, {
  3.8535877486385593`*^9, 3.8535878601525917`*^9}, {3.853588030688436*^9, 
  3.853588064175317*^9}},ExpressionUUID->"c7f4f041-77be-4e93-8b2f-\
c917ff12e54c"],

Cell[CellGroupData[{

Cell["\<\
The NearestFunction is a handy and fast way to test proximity to a given point.
For example:\
\>", "Subsubsection",
 CellChangeTimes->{{3.853588071807828*^9, 3.853588083755827*^9}, {
  3.853588162984466*^9, 
  3.8535881850639267`*^9}},ExpressionUUID->"20493f58-f2a4-497c-8a5c-\
3af33d28d25c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"activeNF", " ", "=", " ", 
  RowBox[{"Nearest", "[", 
   RowBox[{"activePs", "->", "All"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8535881942032213`*^9, 3.8535882161283083`*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[9]:=",ExpressionUUID->"d6acbe9c-8cf4-4a2c-98e0-3915d2eedb29"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["NearestFunction",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{{{
                Directive[
                 PointSize[0.125], 
                 RGBColor[1, 0, 0]], 
                PointBox[{0.5, 0.5}]}, {
                Directive[
                 PointSize[0.125], 
                 GrayLevel[0.5]], 
                
                PointBox[{{0.1795528351379172, 0.0994714438781299}, {
                 0.7056740672325248, 0.6072610584092579}, {0.8751907147676556,
                  0.43365086554091525`}, {0.5311259379568558, 
                 0.7402341039205544}, {0.024850489769640216`, 
                 0.2680094271842395}, {0.8535001476389303, 
                 0.09037709159382268}, {0.18825996468471073`, 
                 0.11580607373374763`}, {0.37580999850411323`, 
                 0.7473443767647248}, {0.7179416455907517, 
                 0.31385476481358254`}, {0.6087567739228883, 
                 0.045415361402344034`}}]}}, {
               Directive[
                PointSize[0.125], 
                GrayLevel[0]], 
               PointBox[{0.7056740672325248, 0.6072610584092579}], 
               AbsoluteDashing[{1, 2}], 
               
               CircleBox[{0.7056740672325248, 0.6072610584092579}, 
                0.23196283448656893`]}}, {
             Background -> GrayLevel[0.93], Axes -> False, AspectRatio -> 1, 
              ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]], PlotRangePadding -> 0.1}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Data points: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Input dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{{{
                Directive[
                 PointSize[0.125], 
                 RGBColor[1, 0, 0]], 
                PointBox[{0.5, 0.5}]}, {
                Directive[
                 PointSize[0.125], 
                 GrayLevel[0.5]], 
                
                PointBox[{{0.1795528351379172, 0.0994714438781299}, {
                 0.7056740672325248, 0.6072610584092579}, {0.8751907147676556,
                  0.43365086554091525`}, {0.5311259379568558, 
                 0.7402341039205544}, {0.024850489769640216`, 
                 0.2680094271842395}, {0.8535001476389303, 
                 0.09037709159382268}, {0.18825996468471073`, 
                 0.11580607373374763`}, {0.37580999850411323`, 
                 0.7473443767647248}, {0.7179416455907517, 
                 0.31385476481358254`}, {0.6087567739228883, 
                 0.045415361402344034`}}]}}, {
               Directive[
                PointSize[0.125], 
                GrayLevel[0]], 
               PointBox[{0.7056740672325248, 0.6072610584092579}], 
               AbsoluteDashing[{1, 2}], 
               
               CircleBox[{0.7056740672325248, 0.6072610584092579}, 
                0.23196283448656893`]}}, {
             Background -> GrayLevel[0.93], Axes -> False, AspectRatio -> 1, 
              ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]], PlotRangePadding -> 0.1}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Data points: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Input dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Output: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"scalar\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Distance function: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Automatic", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  NearestFunction[
   Hold[
    Nearest[{{-0.52, 0}, {0.52, 0}, {-5.643867321622093, 8.510701972502936}, {
       6.278535134328614, 5.960560447186062}, {9.470947179735148, 
       7.858394944673499}} -> All]]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.853859297546989*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[9]=",ExpressionUUID->"57e0d9fd-e6d6-4707-af55-0d1880e3b2dd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
If we want to find the nearest particle at the position {5,5}:\
\>", "Subsubsection",
 CellChangeTimes->{{3.8535882418085327`*^9, 
  3.853588286631489*^9}},ExpressionUUID->"4d0ff029-e876-4d7d-bf31-\
b9d2a59d3ae5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"activeNF", "[", 
  RowBox[{"{", 
   RowBox[{"5", ",", "5"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8535882888891277`*^9, 3.8535882929053383`*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[10]:=",ExpressionUUID->"9b77817e-be23-4337-8a11-8fa88254841a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[LeftAssociation]", 
   RowBox[{
    RowBox[{"\<\"Element\"\>", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"6.278535134328614`", ",", "5.960560447186062`"}], "}"}]}], ",", 
    RowBox[{"\<\"Index\"\>", "\[Rule]", "4"}], ",", 
    RowBox[{"\<\"Distance\"\>", "\[Rule]", "1.5991649265823`"}]}], 
   "\[RightAssociation]"}], "}"}]], "Output",
 CellChangeTimes->{3.8538592975993547`*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[10]=",ExpressionUUID->"1f381e98-2182-49c4-82db-c21abde2b907"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["If we want to find the nearest two particles to particle 5:", \
"Subsubsection",
 CellChangeTimes->{{3.8535882418085327`*^9, 
  3.853588333097262*^9}},ExpressionUUID->"362647b2-3d29-48c7-b46b-\
c692678c8da4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"activeNF", "[", 
  RowBox[{
   RowBox[{"activePs", "[", 
    RowBox[{"[", "5", "]"}], "]"}], ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.853588341651683*^9, 3.85358835125954*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[11]:=",ExpressionUUID->"81f8da61-258e-4f70-bc54-3153bde4b743"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Element\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"9.470947179735148`", ",", "7.858394944673499`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"Index\"\>", "\[Rule]", "5"}], ",", 
     RowBox[{"\<\"Distance\"\>", "\[Rule]", "0.`"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Element\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"6.278535134328614`", ",", "5.960560447186062`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"Index\"\>", "\[Rule]", "4"}], ",", 
     RowBox[{"\<\"Distance\"\>", "\[Rule]", "3.7139292464329645`"}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8538592976093187`*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[11]=",ExpressionUUID->"272eed53-8197-4b7f-9e16-780f2986b056"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Of course, the nearest particle to particle 5 is itself--so the second member \
of the list is an association that tells us the location, index, and distance \
to particle 5.

We want to query all such pairs; we can do that by feeding the \
NearestFunction all the positions:\
\>", "Subsubsection",
 CellChangeTimes->{{3.853588361801429*^9, 3.853588460582745*^9}, {
  3.853588619604751*^9, 
  3.853588636632102*^9}},ExpressionUUID->"3144872b-32af-471f-a8d9-\
22f0e99c74bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"activeNF", "[", 
   RowBox[{"activePs", ",", "2"}], "]"}], "//", "Grid"}]], "Input",
 CellChangeTimes->{{3.853588522741001*^9, 3.8535885978026867`*^9}, {
  3.853588920251648*^9, 3.853588929162821*^9}, {3.853589474775157*^9, 
  3.853589475318836*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[12]:=",ExpressionUUID->"b79da110-36fc-4eee-b287-ea47614e00d3"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.52`"}], ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "1"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "0.`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.52`", ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "2"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "1.04`"}]}], 
      "\[RightAssociation]"}]},
    {
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.52`", ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "2"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "0.`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.52`"}], ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "1"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "1.04`"}]}], 
      "\[RightAssociation]"}]},
    {
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5.643867321622093`"}], ",", "8.510701972502936`"}], 
         "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "0.`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.52`"}], ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "1"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "9.934085986861204`"}]}], 
      "\[RightAssociation]"}]},
    {
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"6.278535134328614`", ",", "5.960560447186062`"}], "}"}]}], 
       ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "4"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "0.`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"9.470947179735148`", ",", "7.858394944673499`"}], "}"}]}], 
       ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "5"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "3.7139292464329645`"}]}], 
      "\[RightAssociation]"}]},
    {
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"9.470947179735148`", ",", "7.858394944673499`"}], "}"}]}], 
       ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "5"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "0.`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"6.278535134328614`", ",", "5.960560447186062`"}], "}"}]}], 
       ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "4"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "3.7139292464329645`"}]}], 
      "\[RightAssociation]"}]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.8538592976150723`*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[12]=",ExpressionUUID->"638a9a7f-57e6-4853-8987-386bd26c4b1a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Each row is a reaction possible reaction.  The first column contains all \
the particles, and the second column the nearest particle.\nThe distances in \
the second row give us a measure of whether the particles will react or not.\n\
\nThere may be some redundant reactions.  If particle ",
 StyleBox["i",
  FontSlant->"Italic"],
 " is nearest to particle ",
 StyleBox["j",
  FontSlant->"Italic"],
 ", then it is possible that particle ",
 StyleBox["j ",
  FontSlant->"Italic"],
 "is also nearest to particle ",
 StyleBox["i",
  FontSlant->"Italic"],
 ".  The redundancies will need to be removed.  It is probably safe to do \
this by eliminating duplicate distances."
}], "Subsubsection",
 CellChangeTimes->{{3.8535886400506573`*^9, 3.8535886479296007`*^9}, {
   3.853588683625511*^9, 3.853588752638709*^9}, {3.853588811576909*^9, 
   3.853588893019734*^9}, {3.853588938431562*^9, 3.853589006596542*^9}, 
   3.853589050872573*^9, {3.853589082594667*^9, 
   3.8535891162425947`*^9}},ExpressionUUID->"db3d922f-717f-4930-b951-\
ec3715138b33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reactions", " ", "=", " ", 
       RowBox[{"activeNF", "[", 
        RowBox[{"activePs", ",", "3"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"reactions", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "#1", "]"}], "[", "\"\<Distance\>\"", "]"}], "==", 
         RowBox[{
          RowBox[{"Last", "[", "#2", "]"}], "[", "\"\<Distance\>\"", "]"}]}], 
        "&"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ")"}], "//", 
  "Grid"}]], "Input",
 CellChangeTimes->{{3.8535891201200953`*^9, 3.8535891446827393`*^9}, {
   3.853589176671611*^9, 3.853589253420895*^9}, {3.853589301830276*^9, 
   3.8535893416707687`*^9}, {3.853589461279406*^9, 3.853589463587596*^9}, {
   3.853589777502267*^9, 3.853589779659005*^9}, {3.853589905105608*^9, 
   3.853589906786623*^9}, {3.8535899923153677`*^9, 3.853589994343346*^9}, {
   3.853590087558489*^9, 3.853590115169429*^9}, 3.853590147965083*^9, {
   3.853837842861816*^9, 3.8538378605636787`*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[13]:=",ExpressionUUID->"e0cc143b-7635-4420-b075-682354f776a8"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.52`"}], ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "1"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "0.`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.52`", ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "2"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "1.04`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"6.278535134328614`", ",", "5.960560447186062`"}], "}"}]}], 
       ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "4"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "9.041480012545485`"}]}], 
      "\[RightAssociation]"}]},
    {
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.52`", ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "2"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "0.`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.52`"}], ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "1"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "1.04`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"6.278535134328614`", ",", "5.960560447186062`"}], "}"}]}], 
       ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "4"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "8.28788318799535`"}]}], 
      "\[RightAssociation]"}]},
    {
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5.643867321622093`"}], ",", "8.510701972502936`"}], 
         "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "0.`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.52`"}], ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "1"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "9.934085986861204`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.52`", ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "2"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "10.508344704249383`"}]}], 
      "\[RightAssociation]"}]},
    {
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"9.470947179735148`", ",", "7.858394944673499`"}], "}"}]}], 
       ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "5"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "0.`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"6.278535134328614`", ",", "5.960560447186062`"}], "}"}]}], 
       ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "4"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "3.7139292464329645`"}]}], 
      "\[RightAssociation]"}], 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"Element\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.52`", ",", "0"}], "}"}]}], ",", 
       RowBox[{"\<\"Index\"\>", "\[Rule]", "2"}], ",", 
       RowBox[{"\<\"Distance\"\>", "\[Rule]", "11.911079989693572`"}]}], 
      "\[RightAssociation]"}]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.8538592976256943`*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[13]=",ExpressionUUID->"e36a6db2-e544-4e7d-b741-bfa0f89f24ca"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Let\[CloseCurlyQuote]s  collapse the two columns into a single \
Association", "Subsubsection",
 CellChangeTimes->{{3.8535895738412523`*^9, 3.853589602842814*^9}, {
  3.853589736297147*^9, 3.853589764990499*^9}, {3.85359005124932*^9, 
  3.853590051958804*^9}},ExpressionUUID->"b0114f70-d9db-4be1-819c-\
3ca22199f944"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"uniqueReactions", " ", "=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"reactions", " ", "=", " ", 
       RowBox[{"activeNF", "[", 
        RowBox[{"activePs", ",", "4"}], "]"}]}], ",", " ", 
      "uniqueReactions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uniqueReactions", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"reactions", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#1", "]"}], "[", "\"\<Distance\>\"", "]"}], "==", 
          RowBox[{
           RowBox[{"Last", "[", "#2", "]"}], "[", "\"\<Distance\>\"", "]"}]}],
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"<|", 
          RowBox[{"\"\<Me\>\"", "->", 
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], "[", "\"\<Index\>\"", "]"}]}], 
          "|>"}], ",", 
         RowBox[{"Last", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
      "uniqueReactions"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.853590151367948*^9, 3.8535901853207293`*^9}, {
  3.853837873500144*^9, 3.853837873717966*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[14]:=",ExpressionUUID->"72c3b3f4-b4f9-44c6-baf3-49567365b9a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Me\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"Element\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5.643867321622093`"}], ",", "8.510701972502936`"}], 
       "}"}]}], ",", 
     RowBox[{"\<\"Index\"\>", "\[Rule]", "3"}], ",", 
     RowBox[{"\<\"Distance\"\>", "\[Rule]", "9.934085986861204`"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Me\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"Element\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5.643867321622093`"}], ",", "8.510701972502936`"}], 
       "}"}]}], ",", 
     RowBox[{"\<\"Index\"\>", "\[Rule]", "3"}], ",", 
     RowBox[{"\<\"Distance\"\>", "\[Rule]", "10.508344704249383`"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Me\"\>", "\[Rule]", "3"}], ",", 
     RowBox[{"\<\"Element\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"6.278535134328614`", ",", "5.960560447186062`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"Index\"\>", "\[Rule]", "4"}], ",", 
     RowBox[{"\<\"Distance\"\>", "\[Rule]", "12.192083584064084`"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Me\"\>", "\[Rule]", "4"}], ",", 
     RowBox[{"\<\"Element\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.52`"}], ",", "0"}], "}"}]}], ",", 
     RowBox[{"\<\"Index\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"Distance\"\>", "\[Rule]", "9.041480012545485`"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Me\"\>", "\[Rule]", "5"}], ",", 
     RowBox[{"\<\"Element\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.52`"}], ",", "0"}], "}"}]}], ",", 
     RowBox[{"\<\"Index\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"Distance\"\>", "\[Rule]", "12.711152451871849`"}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8538592976300783`*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[14]=",ExpressionUUID->"9189a00c-6c0c-40f8-ba4d-f79f6117a791"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
It is also possible that two different elements \[OpenCurlyDoubleQuote]Me\
\[CloseCurlyDoubleQuote] can be closest to the same \
\[OpenCurlyDoubleQuote]Index\[CloseCurlyDoubleQuote], so we need to prune \
those reactions by splitting the reactions by their indices and then picking \
the closest \[OpenCurlyDoubleQuote]Me\[CloseCurlyDoubleQuote]\
\>", "Subsection",
 CellChangeTimes->{{3.85383781242692*^9, 3.853837819861434*^9}, {
  3.8538378868481216`*^9, 
  3.853837959475546*^9}},ExpressionUUID->"cf9ce07b-1c6a-41c0-8dd7-\
eca44061625e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pruneReactions", "[", "reactions_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "splitByIndex", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "reactions", "]"}], "==", "0"}], ",", " ", 
       RowBox[{"Return", "[", "reactions", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "reactions", "]"}], "==", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"Union", "[", 
          RowBox[{"reactions", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "\"\<Index\>\""}], "]"}], "]"}], "]"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "reactions", "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"splitByIndex", " ", "=", " ", 
      RowBox[{"SplitBy", "[", 
       RowBox[{"reactions", ",", 
        RowBox[{"#Index", "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"First", "/@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SortBy", "[", 
         RowBox[{"r", ",", 
          RowBox[{"#Distance", "&"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "splitByIndex"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[15]:=",ExpressionUUID->"2f910598-aadd-4153-8b2d-706138a9e23b"],

Cell[CellGroupData[{

Cell["Then select for a given particle separation (e.g., 1.1)", \
"Subsubsection",
 CellChangeTimes->{{3.8535895738412523`*^9, 3.853589602842814*^9}, {
   3.853589736297147*^9, 3.853589764990499*^9}, {3.85359005124932*^9, 
   3.853590051958804*^9}, {3.85359039157344*^9, 3.8535904187696943`*^9}, 
   3.8538374071360197`*^9},ExpressionUUID->"7059ec1a-e736-4817-a38c-\
f8c2e9eb8f48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"#Distance", " ", "<", " ", "1.1"}], " ", "&"}], "]"}], "[", 
  "uniqueReactions", "]"}]], "Input",
 CellChangeTimes->{{3.8535904235559053`*^9, 3.853590439839321*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[16]:=",ExpressionUUID->"74b131f0-c460-4429-a632-52282e4c6b8c"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.853859297646761*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[16]=",ExpressionUUID->"a565a8e7-a88c-42b8-8989-9892b86fcfda"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["We put these steps together into a single function:", "Subsection",
 CellChangeTimes->{{3.85359047138395*^9, 
  3.853590485371378*^9}},ExpressionUUID->"f3b671c7-03ba-4c93-a776-\
1173c917301e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isolatedParticleReactions", "[", 
   RowBox[{"activeNF_", ",", " ", "particles_", ",", "dx_"}], "]"}], ":=", 
  " ", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"reactions", " ", "=", " ", 
       RowBox[{"activeNF", "[", 
        RowBox[{"particles", ",", "2"}], "]"}]}], ",", " ", 
      "uniqueReactions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uniqueReactions", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"reactions", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#1", "]"}], "[", "\"\<Distance\>\"", "]"}], "==", 
          RowBox[{
           RowBox[{"Last", "[", "#2", "]"}], "[", "\"\<Distance\>\"", "]"}]}],
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"uniqueReactions", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"<|", 
           RowBox[{"\"\<Me\>\"", "->", 
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], "[", "\"\<Index\>\"", "]"}]}], 
           "|>"}], ",", 
          RowBox[{"Last", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
       "uniqueReactions"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"uniqueReactions", "=", " ", 
      RowBox[{"pruneReactions", "[", "uniqueReactions", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"#Distance", " ", "<", " ", 
         RowBox[{"1", " ", "+", " ", "dx"}]}], " ", "&"}], "]"}], "[", 
      "uniqueReactions", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.853590487771756*^9, 3.853590569725799*^9}, {
   3.8535906019645042`*^9, 3.853590658747407*^9}, 3.853590718582962*^9, {
   3.853678534342628*^9, 3.853678549975027*^9}, {3.853837979423646*^9, 
   3.853838017560473*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[17]:=",ExpressionUUID->"65cc338d-b4f9-414f-b618-0c00fe03e62a"],

Cell[CellGroupData[{

Cell["\<\
We want to go through the list of reactions, move each particle so that it is \
touching, and keep a list of particle indices that need to turn into dimers.  \
This function will return the new positions of all of the particles and a \
flat list of particles that react.\
\>", "Subsubsection",
 CellChangeTimes->{{3.853590756668717*^9, 
  3.853590899268962*^9}},ExpressionUUID->"42107a55-a5c9-4a89-b895-\
e2e31f2f026f"],

Cell["\<\
dr is a vector from \[OpenCurlyDoubleQuote]me\[CloseCurlyDoubleQuote] to \
\[OpenCurlyDoubleQuote]it\[CloseCurlyDoubleQuote].  The particles move along \
that vector so that they touch (i.e., their distance is 1).\
\>", "Text",
 CellChangeTimes->{{3.8535911735537167`*^9, 3.853591188827888*^9}, {
  3.85359123207329*^9, 
  3.853591268786192*^9}},ExpressionUUID->"9dbe7e56-7f7b-4550-b087-\
3800e9f6712b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"isolatedToDimer", "[", 
    RowBox[{"particles_", ",", "activeNF_", ",", "dx_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"positions", " ", "=", " ", "particles"}], ",", 
       RowBox[{"reactions", " ", "=", 
        RowBox[{"isolatedParticleReactions", "[", 
         RowBox[{"activeNF", ",", "particles", ",", "dx"}], "]"}]}], " ", ",",
        " ", "reactants"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reactants", " ", "=", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"me", " ", "=", " ", 
               RowBox[{"#", "[", "\"\<Me\>\"", "]"}]}], ",", 
              RowBox[{"it", " ", "=", " ", 
               RowBox[{"#", "[", "\"\<Index\>\"", "]"}]}], ",", "dr", " ", 
              ",", 
              RowBox[{"dist", "=", " ", 
               RowBox[{
                RowBox[{"#", "[", "\"\<Distance\>\"", "]"}], "-", "1"}]}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dr", " ", "=", " ", 
              RowBox[{
               RowBox[{"particles", "[", 
                RowBox[{"[", "it", "]"}], "]"}], "-", " ", 
               RowBox[{"particles", "[", 
                RowBox[{"[", "me", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"positions", "[", 
               RowBox[{"[", "me", "]"}], "]"}], " ", "=", " ", 
              RowBox[{
               RowBox[{"particles", "[", 
                RowBox[{"[", "me", "]"}], "]"}], " ", "+", " ", 
               RowBox[{"dist", " ", 
                RowBox[{"dr", "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"positions", "[", 
               RowBox[{"[", "it", "]"}], "]"}], " ", "=", " ", 
              RowBox[{
               RowBox[{"particles", "[", 
                RowBox[{"[", "it", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"dist", " ", 
                RowBox[{"dr", "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"me", ",", "it"}], "}"}]}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", "reactions"}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"positions", ",", 
        RowBox[{"Flatten", "[", "reactants", "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.853586777334608*^9, 3.853586870522543*^9}, {
   3.8535870311630983`*^9, 3.853587197365837*^9}, {3.8535872380296583`*^9, 
   3.85358724655567*^9}, {3.85358728947604*^9, 3.853587291419819*^9}, {
   3.853590933526119*^9, 3.853591154383906*^9}, {3.853591206850066*^9, 
   3.853591219861508*^9}, {3.8535913016811237`*^9, 3.853591332165176*^9}, 
   3.8535913724495687`*^9, {3.853665744953898*^9, 3.853665857868733*^9}, {
   3.8536756340102997`*^9, 3.8536756369943047`*^9}, {3.8536757426632767`*^9, 
   3.853675767053595*^9}, {3.853678574694191*^9, 3.853678582734208*^9}, {
   3.853678992146654*^9, 3.853678997429187*^9}, {3.853679705953149*^9, 
   3.853679708386099*^9}, {3.853679760014583*^9, 3.853679762207346*^9}, {
   3.853679881163521*^9, 3.853679881546033*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[18]:=",ExpressionUUID->"d5f407a9-12e3-474d-aaf6-674500b0e08b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Eliminating Collisions between Isolated Particles and Internal Particles \
(i.e., the non-reactive particles within a polymer chain).\
\>", "Section",
 CellChangeTimes->{{3.853587375074683*^9, 3.8535873914799347`*^9}, {
  3.8535918365083847`*^9, 
  3.853591915115965*^9}},ExpressionUUID->"bcd3c881-faef-441b-972f-\
783580b3f1ab"],

Cell[CellGroupData[{

Cell["\<\
Suppose we have a lists of active particles and internal particles\
\>", "Subsubsection",
 CellChangeTimes->{{3.853591939423567*^9, 3.853591959323905*^9}, 
   3.853649373734749*^9},ExpressionUUID->"4b775aed-235c-43ad-ba4d-\
9bf47d4c2177"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"internalParticles", " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", 
      RowBox[{"Tan", "[", 
       RowBox[{"Pi", "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", "48"}], ")"}]}], "]"}]}]], 
    RowBox[{"AngleVector", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", "23"}], "]"}], 
       RowBox[{"Pi", "/", "48"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"terminatingParticles", "=", " ", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", " ", 
      RowBox[{"Tan", "[", 
       RowBox[{"Pi", "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", "48"}], ")"}]}], "]"}]}]], 
    RowBox[{"AngleVector", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "24"}], "}"}], 
       RowBox[{"Pi", "/", "48"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sideLength", " ", "=", " ", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", 
   RowBox[{"HardcorePointProcess", "[", 
    RowBox[{"1", ",", "4", ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reg", " ", "=", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "sideLength"}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "/", "2"}]}], ",", 
     RowBox[{"sideLength", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "/", "2"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"particles", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomPointConfiguration", "[", 
       RowBox[{"proc", ",", "reg"}], "]"}], "[", "\"\<Points\>\"", "]"}], ",",
      " ", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", " ", 
            RowBox[{"Tan", "[", 
             RowBox[{"Pi", "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", "48"}], ")"}]}], "]"}]}]], "-", "1"}], "<", 
         " ", 
         RowBox[{"Norm", "[", "#", "]"}], " ", "<", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", " ", 
            RowBox[{"Tan", "[", 
             RowBox[{"Pi", "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", "48"}], ")"}]}], "]"}]}]], "+", "1"}]}], 
        ")"}]}], "&"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.8527187866943493`*^9, {3.852718890509068*^9, 3.852718890672132*^9}, {
   3.8528878696748343`*^9, 3.852887870263976*^9}, {3.852889532664887*^9, 
   3.852889548231*^9}, {3.853131589493806*^9, 3.8531316251074553`*^9}, {
   3.85313171856728*^9, 3.853131719889461*^9}, {3.8531317812658577`*^9, 
   3.853131816327731*^9}, {3.8531327980908117`*^9, 3.853132798197062*^9}, {
   3.85314966678754*^9, 3.853149674991735*^9}, {3.853149836970407*^9, 
   3.853149837270117*^9}, {3.853150186296794*^9, 3.8531501870973883`*^9}, {
   3.8531503055018387`*^9, 3.853150332713459*^9}, {3.8531503991051397`*^9, 
   3.853150400759012*^9}, 3.853150494226112*^9, {3.853157559955298*^9, 
   3.8531575604882517`*^9}, {3.85315813915548*^9, 3.8531581634780273`*^9}, {
   3.853158195187738*^9, 3.853158195564623*^9}, {3.8535843791719627`*^9, 
   3.853584386304508*^9}, {3.85358443560876*^9, 3.8535844390405416`*^9}, {
   3.853584543144823*^9, 3.853584543231165*^9}, {3.853584622368722*^9, 
   3.8535846224332113`*^9}, 3.853587541861071*^9, {3.853649051064879*^9, 
   3.8536491412613983`*^9}, {3.853649192439783*^9, 3.853649281867621*^9}, {
   3.8536493139023447`*^9, 3.8536493160299*^9}, {3.85364934633681*^9, 
   3.853649354680591*^9}},
 CellLabel->"2/14/22 21:28:17 (extra_kernel) In[19]:=",
 CellID->1782067018,ExpressionUUID->"1bf0ade0-778c-41f8-9f53-b48473a9c2ff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polymerGraphic", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "particles", ",", "terminatingParticles", ",", "internalParticles"}], 
    "}"}], ",", " ", "sideLength"}], "]"}]], "Input",
 CellChangeTimes->{{3.8536491513874483`*^9, 3.853649180391901*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[25]:=",ExpressionUUID->"b8d68d91-3f5c-426c-becb-bdeacd72d567"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[1, 0, 0], 
    DiskBox[{21.53600621977818, -14.807226029416354}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{17.247630826056128, -5.956692182302758}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{21.825631707857283, -24.231553708051834}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{21.0966589162628, -4.355349121564367}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{20.495322326796128, -18.90380825491186}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-14.632435285551626, -23.641513020333637}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{1.8740701855211706, -12.618698171034659}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{14.162376519462704, -19.6062141091883}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{2.7961313608093397, 3.34180487751925}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-19.38562298605727, -20.408636516503154}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-23.74989489045969, -4.790712834205523}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-8.210337776669096, -24.151711848808443}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-4.433474091756684, 16.963371755206722}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{12.813007735361925, -14.828024319557166}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{24.92802695903904, 5.525576899027307}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-16.68584062357067, 21.873239627658737}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{0.056383043906693686, 12.77284131838159}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-10.017259167684712, 18.069547580254053}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-3.5516377842480518, -23.619521991201474}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{18.241383989338477, -12.42808437734233}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-14.768481546206658, -17.879154213530068}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-24.437887547689975, -16.84228237529809}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{0.05929209962500792, -18.264396442707653}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-8.968955238988052, -5.654062317033704}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{20.77561969960492, 3.7738651994111194}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{0.9888134876597232, 16.787013446092903}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-5.052447942477755, -9.655846440940497}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{4.854304684905763, -6.4794841543092785}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-4.133783615600828, 3.071067401684857}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{8.148502764348564, -0.4541434754160245}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{2.831587351983056, -2.1200703191947667}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{0.07722653811851332, 24.60677570466806}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{13.08325597126203, 14.354258179182356}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-1.7614409221619387, -0.19600186051141888}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{17.188161032169635, -16.57289015959038}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-17.89991633945912, 15.213811045270864}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{10.966593415619663, 2.5960534508524313}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{16.624139410870576, 5.072533243325239}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-14.083575053023445, 17.855190023346125}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{24.802847525947858, -21.20161058679697}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{12.085417663852894, 24.95228881229351}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{14.047175306580705, -9.324927691279228}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-8.001977295362972, 22.058723014312353}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{3.1985346320571817, 8.986193910873197}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-4.3442687715074975, -4.704363579663163}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-22.573803833812356, 24.543409134848403}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-19.090845327405724, -24.730961434797226}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-2.2215197179170088, 20.763328096641064}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{0.7266254393670235, -24.298514704751597}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{24.903810434588625, 13.355437955151494}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-4.8066110667721045, 9.974704433534576}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{17.37861495685642, -24.586982500281685}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-16.593945968560952, -12.482981474769183}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{23.140667917825088, 9.228499988132121}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{21.572733640592144, 17.22803229101746}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{12.388412257617043, -2.087367407400764}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-20.827328479040908, -10.883092363317859}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-8.068048955306995, -18.93363891386174}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-0.3483136664112818, 6.249125111994836}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-19.56974440668614, 3.5401036537721198}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-9.170255845977648, 5.310602948444021}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{23.89971689389411, 0.1280003135686214}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-20.619315037675033, 8.254803661725973}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-24.689235906853966, 1.2696789731847513}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-15.232818127518577, -7.9561715045162735}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{14.134359822646669, 18.94076930452616}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{17.1343214271102, 23.480402503156984}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-11.603798752774397, 23.88482797831315}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-21.798816515432407, 19.19536766928318}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-17.612218691528835, 11.068308819353467}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-4.2502188230058024, 24.47756779919382}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{12.033560553391375, -24.337921440738974}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{2.8453188536466167, 21.266944117483266}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-11.133629881621875, -15.871458956449825}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{9.877953162278896, -18.754099371985134}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{21.903064536408934, 24.79404220723683}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{7.012147586344875, 4.037396404404026}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-19.07154035653107, -0.5089454678507188}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-9.385054889663058, -0.1648498920077568}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{5.745290171020134, -23.127497691708875}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{7.746824637129923, 8.775287606849302}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{7.144867897373763, 15.070253786888156}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{10.009652133393466, 20.86205143155695}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-20.256260542591264, -15.226892346813859}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{20.65233914806448, 12.433309459297659}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-24.15928171670798, 5.25731860300831}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-23.394828942978606, -21.467979649459046}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{22.79612541329209, -10.5158317106406}, NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[{-24.485608484756625, 10.342763450379666}, NCache[
     Rational[1, 2], 0.5]]}, 
   {RGBColor[1, 0.5, 0], 
    DiskBox[NCache[{Rational[1, 2] Cot[Rational[1, 96] Pi], 0}, {
      15.273419993472029`, 0}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{0, Rational[1, 2] Cot[Rational[1, 96] Pi]}, {
      0, 15.273419993472029`}], NCache[Rational[1, 2], 0.5]]}, 
   {RGBColor[0, 0, 1], 
    DiskBox[NCache[{
      Rational[1, 2] Cos[Rational[1, 48] Pi] Cot[Rational[1, 96] Pi], 
       Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[1, 48] Pi]}, {
      15.240718428856956`, 0.9989294616193019}], NCache[Rational[1, 2], 0.5]],
     DiskBox[NCache[{
      Rational[1, 2] Cos[Rational[1, 24] Pi] Cot[Rational[1, 96] Pi], 
       Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[1, 24] Pi]}, {
      15.14275376813186, 1.993581353925509}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cos[Rational[1, 16] Pi] Cot[Rational[1, 96] Pi], 
       Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[1, 16] Pi]}, {
      14.979945511013769`, 2.9796964248140294`}], NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 4] 2^Rational[-1, 2] (1 + 3^Rational[1, 2]) 
       Cot[Rational[1, 96] Pi], Rational[1, 4] 
       2^Rational[-1, 2] (-1 + 3^Rational[1, 2]) Cot[Rational[1, 96] Pi]}, {
      14.752990827454443`, 3.9530519781601785`}], NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cos[Rational[5, 48] Pi] Cot[Rational[1, 96] Pi], 
       Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[5, 48] Pi]}, {
      14.462861572251605`, 4.909479956052267}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cos[Rational[1, 8] Pi] Cot[Rational[1, 96] Pi], 
       Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[1, 8] Pi]}, {
      14.110800123417478`, 5.844884787055463}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cos[Rational[7, 48] Pi] Cot[Rational[1, 96] Pi], 
       Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[7, 48] Pi]}, {
      13.698314062125432`, 6.755260924077451}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 4] 3^Rational[1, 2] Cot[Rational[1, 96] Pi], Rational[1, 4] 
       Cot[Rational[1, 96] Pi]}, {13.227169717015931`, 7.636709996736014}], 
     NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cos[Rational[3, 16] Pi] Cot[Rational[1, 96] Pi], 
       Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[3, 16] Pi]}, {
      12.69938460050613, 8.485457504779506}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[
     NCache[{Rational[1, 2] Cos[Rational[5, 24] Pi] Cot[Rational[1, 96] Pi], 
       Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[5, 24] Pi]}, {
      12.11721876949197, 9.297868981076396}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cos[Rational[11, 48] Pi] Cot[Rational[1, 96] Pi], 
       Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[11, 48] Pi]}, {
      11.483165147437576`, 10.070465554961503`}], NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] 2^Rational[-1, 2] Cot[Rational[1, 96] Pi], 
       Rational[1, 2] 2^Rational[-1, 2] Cot[Rational[1, 96] Pi]}, {
      10.799938849294264`, 10.799938849294264`}], NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[11, 48] Pi], 
       Rational[1, 2] Cos[Rational[11, 48] Pi] Cot[Rational[1, 96] Pi]}, {
      10.070465554961503`, 11.483165147437576`}], NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[5, 24] Pi], 
       Rational[1, 2] Cos[Rational[5, 24] Pi] Cot[Rational[1, 96] Pi]}, {
      9.297868981076396, 12.11721876949197}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[3, 16] Pi], 
       Rational[1, 2] Cos[Rational[3, 16] Pi] Cot[Rational[1, 96] Pi]}, {
      8.485457504779506, 12.69938460050613}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 4] Cot[Rational[1, 96] Pi], Rational[1, 4] 3^Rational[1, 2] 
       Cot[Rational[1, 96] Pi]}, {7.636709996736014, 13.227169717015931`}], 
     NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[7, 48] Pi], 
       Rational[1, 2] Cos[Rational[7, 48] Pi] Cot[Rational[1, 96] Pi]}, {
      6.755260924077451, 13.698314062125432`}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[1, 8] Pi], 
       Rational[1, 2] Cos[Rational[1, 8] Pi] Cot[Rational[1, 96] Pi]}, {
      5.844884787055463, 14.110800123417478`}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[
     NCache[{Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[5, 48] Pi], 
       Rational[1, 2] Cos[Rational[5, 48] Pi] Cot[Rational[1, 96] Pi]}, {
      4.909479956052267, 14.462861572251605`}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 4] 2^Rational[-1, 2] (-1 + 3^Rational[1, 2]) 
       Cot[Rational[1, 96] Pi], Rational[1, 4] 
       2^Rational[-1, 2] (1 + 3^Rational[1, 2]) Cot[Rational[1, 96] Pi]}, {
      3.9530519781601785`, 14.752990827454443`}], NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[1, 16] Pi], 
       Rational[1, 2] Cos[Rational[1, 16] Pi] Cot[Rational[1, 96] Pi]}, {
      2.9796964248140294`, 14.979945511013769`}], NCache[
     Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[1, 24] Pi], 
       Rational[1, 2] Cos[Rational[1, 24] Pi] Cot[Rational[1, 96] Pi]}, {
      1.993581353925509, 15.14275376813186}], NCache[Rational[1, 2], 0.5]], 
    DiskBox[NCache[{
      Rational[1, 2] Cot[Rational[1, 96] Pi] Sin[Rational[1, 48] Pi], 
       Rational[1, 2] Cos[Rational[1, 48] Pi] Cot[Rational[1, 96] Pi]}, {
      0.9989294616193019, 15.240718428856956`}], NCache[
     Rational[1, 2], 0.5]]}},
  Background->RGBColor[0.87, 0.94, 1],
  ImageSize->400,
  PlotRange->{{-25.5, 25.5}, {-25.5, 25.5}},
  Ticks->None]], "Output",
 CellChangeTimes->{3.853859297680996*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[25]=",ExpressionUUID->"775aad53-38fe-4f6c-9594-400cafe57a16"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We want to eliminate collisions between the random-walking isolated particles \
and the internal inert particles.
\[LineSeparator]We already have a Nearest function for the isolated \
particles.  We can use that to test if any of them overlap by scanning over \
the list of internal particles.  We construct a  function will also two \
particle lists for the isolated particles\[LongDash]one for the positions \
before and one for the positions after the random step. If any isolated \
particle overlaps, it is returned to its original position.\
\>", "Subsubsection",
 CellChangeTimes->{{3.853591939423567*^9, 3.853591959323905*^9}, 
   3.853649373734749*^9, {3.8536494050975*^9, 3.853649442268229*^9}, {
   3.8536648414809723`*^9, 3.853665061675852*^9}, {3.853665099949271*^9, 
   3.853665128879923*^9}, {3.853665169070611*^9, 
   3.853665298408584*^9}},ExpressionUUID->"d8f61233-2fe6-4f65-9b14-\
78f113ce9e80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"removeInternalParticleOverlaps", "[", 
   RowBox[{"internalParticles_", ",", 
    RowBox[{"{", 
     RowBox[{"particlesBefore_", ",", " ", "particlesAfter_"}], "}"}], ",", 
    " ", "isolatedParticlesNF_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"eliminateRandomStep", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#Distance", " ", "<", " ", "1"}], " ", "&"}], "]"}], "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"isolatedParticlesNF", "[", "internalParticles", "]"}], 
         "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"particlePositions", " ", "=", " ", "particlesAfter"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"eliminateRandomStep", "==", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Return", "[", "particlesAfter", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indices", " ", "=", " ", 
         RowBox[{"eliminateRandomStep", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Index\>\""}], "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"particlePositions", "[", 
         RowBox[{"[", "indices", "]"}], "]"}], "=", " ", 
        RowBox[{"particlesBefore", "[", 
         RowBox[{"[", "indices", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "particlePositions"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.853665308557506*^9, 3.853665434547545*^9}, {
   3.853665469150332*^9, 3.8536656525216093`*^9}, 3.853680248939889*^9, {
   3.85368034946279*^9, 3.853680374308984*^9}, {3.853680955909672*^9, 
   3.853680987720488*^9}, 3.853848846563347*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[26]:=",ExpressionUUID->"68ed6c05-a306-46e1-b0c5-0f9778f91483"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Isolated Particles Reacting with Polymer-Terminating Particles.\
\>", "Section",
 CellChangeTimes->{{3.853587375074683*^9, 3.8535873914799347`*^9}, {
  3.8535918365083847`*^9, 3.853591915115965*^9}, {3.853665657748879*^9, 
  3.853665690286356*^9}},ExpressionUUID->"562b2825-307e-4438-9210-\
839d889df8c8"],

Cell["\<\
We use a technique similar to the creation of dimers.  We use the \
NearestFunction to scan over the terminating particles, if any of them are \
within a reaction distance, the isolated particle is moved so it touches the \
(previously) terminating particle.  The function returns the new positions of \
the isolated particles.\
\>", "Subsubsection",
 CellChangeTimes->{{3.8536659141023903`*^9, 3.8536660086015797`*^9}, {
  3.853666052707219*^9, 
  3.853666081671879*^9}},ExpressionUUID->"cf8ba666-d3da-461c-b3f8-\
e1c35221bfb0"],

Cell[CellGroupData[{

Cell["\<\
First we use the nearest function on all the terminating particles:\
\>", "Subsubsection",
 CellChangeTimes->{{3.853666338203114*^9, 
  3.853666366675578*^9}},ExpressionUUID->"7c56d714-ec70-4226-9560-\
8b19c90cc250"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"activeNF", "[", 
   RowBox[{"terminatingParticles", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.853666313335293*^9, 3.853666317317773*^9}, {
  3.853666370071196*^9, 3.853666374777145*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[27]:=",ExpressionUUID->"9baa3905-1b0b-4a8c-8792-e25eb45e775d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Element\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"9.470947179735148`", ",", "7.858394944673499`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"Index\"\>", "\[Rule]", "5"}], ",", 
     RowBox[{"\<\"Distance\"\>", "\[Rule]", "9.768472852018661`"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Element\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5.643867321622093`"}], ",", "8.510701972502936`"}], 
       "}"}]}], ",", 
     RowBox[{"\<\"Index\"\>", "\[Rule]", "3"}], ",", 
     RowBox[{"\<\"Distance\"\>", "\[Rule]", "8.808381995305032`"}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.853859297697702*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[27]=",ExpressionUUID->"10756ea6-d811-429d-b191-1f78efee465f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
and then create an association that identifies the terminating particle and \
then select by distance:\
\>", "Subsubsection",
 CellChangeTimes->{{3.853666420987821*^9, 3.853666444029942*^9}, {
  3.853666553116146*^9, 3.8536665699673433`*^9}, {3.853666613136964*^9, 
  3.8536666229429092`*^9}},ExpressionUUID->"c166485e-caae-4bd3-951a-\
72ae4cc44e5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"terminatingParticleReactions", "[", " ", 
   RowBox[{
   "terminatingParticles_", ",", "particles_", ",", "activeNF_", ",", "dx_"}],
    "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"positions", " ", "=", "particles"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"possibleReactions", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"activeNF", "[", 
         RowBox[{"terminatingParticles", ",", "1"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", " ", "terminalReactions", ",", 
      "isolatedParticleToTerminating", ",", "terminatingParticlesToPolymer"}],
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"possibleReactions", "=", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"#", ",", 
           RowBox[{"<|", 
            RowBox[{"\"\<Terminator\>\"", "->", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "|>"}]}], "]"}], "&"}], ",", 
        "possibleReactions"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"terminalReactions", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"#Distance", " ", "<", " ", 
          RowBox[{"1", " ", "+", " ", "dx"}]}], " ", "&"}], "]"}], "[", 
       "possibleReactions", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "terminalReactions", "]"}], "==", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"positions", ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"terminalReactions", " ", "=", " ", 
      RowBox[{"pruneReactions", "[", "terminalReactions", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "isolatedParticleToTerminating", ",", 
        "terminatingParticlesToPolymer"}], "}"}], "=", "\[IndentingNewLine]", 
      
      RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Block", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"terminator", " ", "=", " ", "#Terminator"}], ",", 
             RowBox[{"isolated", "=", " ", "#Index"}], ",", "dr", ",", 
             RowBox[{"dist", "=", "#Distance"}]}], " ", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dr", " ", "=", 
             RowBox[{
              RowBox[{"positions", "[", 
               RowBox[{"[", "isolated", "]"}], "]"}], "-", " ", 
              RowBox[{"terminatingParticles", "[", 
               RowBox[{"[", "terminator", "]"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"positions", "[", 
              RowBox[{"[", "isolated", "]"}], "]"}], " ", "-=", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"dist", "-", "1"}], ")"}], " ", "dr"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"isolated", ",", "terminator"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "/@", "terminalReactions"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "positions", ",", "isolatedParticleToTerminating", ",", 
       "terminatingParticlesToPolymer"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.853666139899914*^9, 3.853666277593074*^9}, {
   3.853666488696121*^9, 3.853666640542028*^9}, {3.853666938169467*^9, 
   3.853666963953538*^9}, {3.853667007397087*^9, 3.853667008472116*^9}, {
   3.853667042486745*^9, 3.853667362466879*^9}, {3.853667426354328*^9, 
   3.85366751267885*^9}, {3.853668390371957*^9, 3.853668395221243*^9}, {
   3.853679932945763*^9, 3.8536799456156263`*^9}, {3.853682423343411*^9, 
   3.8536824293353653`*^9}, {3.8536825434022427`*^9, 3.853682551890538*^9}, {
   3.853682590994465*^9, 3.8536825924230547`*^9}, {3.853736068941484*^9, 
   3.85373609010256*^9}, 3.853838067322082*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[28]:=",ExpressionUUID->"aa828bf9-639c-46eb-aec1-d7d5b700a8ab"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Update all particles", "Section",
 CellChangeTimes->{{3.853587375074683*^9, 3.8535873914799347`*^9}, {
  3.8535918365083847`*^9, 3.853591915115965*^9}, {3.853665657748879*^9, 
  3.853665690286356*^9}, {3.853667751366269*^9, 
  3.853667769513646*^9}},ExpressionUUID->"bc86c625-4b15-4a59-b91d-\
6bcfd0fe3197"],

Cell[CellGroupData[{

Cell["\<\
The above steps are combined into a function to update all of the particles.  \
This function creates the NearestFunction and passes it to the \
helper-functions we wrote above, collects the indices of particles that need \
to be inserted and deleted in the isolated, terminating, and internal lists, \
and then performs those insertions and deletions\
\>", "Subsubsection",
 CellChangeTimes->{{3.853667777416936*^9, 3.853667829851318*^9}, {
  3.8536701416265917`*^9, 
  3.853670207788185*^9}},ExpressionUUID->"c292f86d-2d84-41e9-b7c1-\
830a23019d0c"],

Cell["\<\
Everything we have done doesn\[CloseCurlyQuote]t depend on the dimensionality \
of the space.  The only thing that matters is how we take the random step.
We can use the dimensionality of the first active particle to determine that.\
\
\>", "Text",
 CellChangeTimes->{{3.8536704870940723`*^9, 
  3.853670656138661*^9}},ExpressionUUID->"45361c51-8049-4727-9867-\
dc45d2f4b803"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"updateParticles", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "activeParticles_", ",", "terminatingParticles_", ",", 
       "internalParticles_"}], "}"}], ",", " ", "dx_", ",", " ", 
     "domainSize_"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newTerminatingParticles", "=", "terminatingParticles"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"newInternalParticles", "=", "internalParticles"}], ",", 
       "\[IndentingNewLine]", "newActiveParticlePositions", " ", ",", 
       "\[IndentingNewLine]", "remainingActiveParticles", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"isolatedParticleToDimers", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"isolatedParticleToTerminating", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"terminatingParticlesToPolymer", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "activeNF", ",", 
       "\[IndentingNewLine]", "nSphere", ",", "domain"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "activeParticles", "]"}], "<=", " ", "1"}], 
        ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
          "activeParticles", ",", "terminatingParticles", ",", 
           "internalParticles"}], "}"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"activeParticles", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "2"}], ",", 
        RowBox[{"nSphere", "=", "Circle"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"activeParticles", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "3"}], ",", 
        RowBox[{"nSphere", "=", "Sphere"}], ",", "\[IndentingNewLine]", 
        "True", ",", 
        RowBox[{"Echo", "[", "\"\<\>\"", "]"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"newActiveParticlePositions", " ", "=", " ", 
       RowBox[{"Clip", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"activeParticles", "+", " ", 
          RowBox[{"dx", " ", 
           RowBox[{"RandomPoint", "[", 
            RowBox[{
             RowBox[{"nSphere", "[", "]"}], ",", 
             RowBox[{"Length", "[", "activeParticles", "]"}]}], "]"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"domainSize", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"activeNF", "=", " ", 
       RowBox[{"Nearest", "[", 
        RowBox[{"newActiveParticlePositions", "->", "All"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "newActiveParticlePositions", ",", "isolatedParticleToDimers"}], 
        "}"}], "=", 
       RowBox[{
        StyleBox["isolatedToDimer",
         Background->RGBColor[1, 1, 0.85]], "[", 
        RowBox[{"newActiveParticlePositions", ",", "activeNF", ",", "dx"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "internalParticles", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"newActiveParticlePositions", " ", "=", " ", 
         RowBox[{
          StyleBox["removeInternalParticleOverlaps",
           Background->RGBColor[1, 1, 0.85]], "[", 
          RowBox[{"internalParticles", ",", 
           RowBox[{"{", 
            RowBox[{"activeParticles", ",", "newActiveParticlePositions"}], 
            "}"}], ",", "activeNF"}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "terminatingParticles", "]"}], ">", "0"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "newActiveParticlePositions", ",", "isolatedParticleToTerminating", 
           ",", "terminatingParticlesToPolymer"}], "}"}], "=", 
         "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["terminatingParticleReactions",
           Background->RGBColor[1, 1, 0.85]], "[", 
          RowBox[{
          "terminatingParticles", ",", "newActiveParticlePositions", ",", 
           "activeNF", ",", "dx"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "displayisolatedParticleToTerminating", ",", 
         "displayterminatingParticlesToPolymer"}], "}"}], "=", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "isolatedParticleToTerminating", ",", 
         "terminatingParticlesToPolymer"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"isolatedParticleToDimers", "==", " ", 
           RowBox[{"{", "}"}]}], " ", "&&", " ", 
          RowBox[{"isolatedParticleToTerminating", "==", " ", 
           RowBox[{"{", "}"}]}]}], ")"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
          "newActiveParticlePositions", ",", "newTerminatingParticles", ",", 
           "newInternalParticles"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"remainingActiveParticles", "  ", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"newActiveParticlePositions", ",", 
         RowBox[{"List", "/@", 
          RowBox[{"Catenate", "[", 
           RowBox[{"{", 
            RowBox[{
            "isolatedParticleToDimers", ",", 
             "isolatedParticleToTerminating"}], "}"}], "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "terminatingParticlesToPolymer", "]"}], "!=", 
         "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "displaynewInternalParticles", "=", " ", 
          "terminatingParticlesToPolymer"}], ";", "\[IndentingNewLine]", 
         RowBox[{"newInternalParticles", " ", "=", " ", 
          RowBox[{"(*", 
           RowBox[{
           "move", " ", "terminating", " ", "particles", " ", "that", " ", 
            "reacted", " ", "to", " ", "internal"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Union", "@", 
           RowBox[{"Catenate", "[", 
            RowBox[{"{", 
             RowBox[{"newInternalParticles", ",", 
              RowBox[{"newTerminatingParticles", "[", 
               RowBox[{"[", "terminatingParticlesToPolymer", "]"}], "]"}]}], 
             "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newTerminatingParticles", "=", " ", 
          RowBox[{"Union", "@", 
           RowBox[{"Catenate", "[", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"newActiveParticlePositions", "[", 
               RowBox[{"[", "isolatedParticleToTerminating", "]"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Delete", "[", 
               RowBox[{"newTerminatingParticles", ",", 
                RowBox[{"List", "/@", "terminatingParticlesToPolymer"}]}], 
               "]"}]}], "}"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "isolatedParticleToDimers", "]"}], " ", "!=", 
         " ", "0"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "add", " ", "isolated", " ", "particles", " ", "that", " ", 
           "reacted"}], ",", " ", 
          RowBox[{
          "delete", " ", "those", " ", "that", " ", "moved", " ", "to", " ", 
           "internal"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newTerminatingParticles", "=", " ", "\[IndentingNewLine]", 
         RowBox[{"Catenate", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newActiveParticlePositions", "[", 
             RowBox[{"[", 
              RowBox[{"Union", "@", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "isolatedParticleToDimers", ",", 
                  "isolatedParticleToTerminating"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", "\[IndentingNewLine]", "newTerminatingParticles"}], 
           "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "remainingActiveParticles", ",", "newTerminatingParticles", ",", 
        "newInternalParticles"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.852719167787373*^9, 3.8527193358646183`*^9}, {
   3.85273134197637*^9, 3.85273135802906*^9}, {3.8527314516769943`*^9, 
   3.8527314648320713`*^9}, {3.852732884289462*^9, 3.852732960130377*^9}, {
   3.852733000670683*^9, 3.8527330306549683`*^9}, {3.852739313173771*^9, 
   3.85273932386372*^9}, {3.852779983634048*^9, 3.852779983980237*^9}, {
   3.852780138982004*^9, 3.852780139316366*^9}, {3.852780182408214*^9, 
   3.852780262998719*^9}, {3.852780295487379*^9, 3.8527803660410347`*^9}, {
   3.8527804023577623`*^9, 3.852780480063431*^9}, {3.8527805139544773`*^9, 
   3.8527805226702223`*^9}, {3.852781279390926*^9, 3.852781305880959*^9}, {
   3.852783041486771*^9, 3.852783127315838*^9}, {3.8527831670627193`*^9, 
   3.852783173189006*^9}, {3.852783220054055*^9, 3.852783228206881*^9}, {
   3.8527833223185177`*^9, 3.8527833259115868`*^9}, {3.852783364266552*^9, 
   3.8527833774054728`*^9}, {3.852783556330336*^9, 3.852783565497033*^9}, {
   3.85278422684181*^9, 3.85278428450078*^9}, {3.852784390479362*^9, 
   3.852784406389011*^9}, {3.852784502773486*^9, 3.852784680043311*^9}, {
   3.8527847113365583`*^9, 3.8527847396829453`*^9}, {3.852784830727974*^9, 
   3.852784831672535*^9}, 3.8527849528836517`*^9, {3.852785756541808*^9, 
   3.852785757092917*^9}, 3.8527865497614107`*^9, {3.852786903739585*^9, 
   3.8527870269573298`*^9}, {3.85278790628959*^9, 3.852787968882346*^9}, {
   3.852788009861149*^9, 3.8527880349129066`*^9}, {3.852788068010993*^9, 
   3.8527881165139303`*^9}, {3.852807054133333*^9, 3.8528070676599894`*^9}, {
   3.852807153242278*^9, 3.852807365078628*^9}, {3.85280742708352*^9, 
   3.8528074742346573`*^9}, {3.852807507893805*^9, 3.8528075399520187`*^9}, {
   3.8528081589348993`*^9, 3.852808334236363*^9}, {3.852809092577772*^9, 
   3.85280909861796*^9}, {3.85280916230247*^9, 3.852809488146655*^9}, {
   3.852809553578477*^9, 3.852809600529374*^9}, {3.852809715877953*^9, 
   3.852809981674493*^9}, {3.8528100301787024`*^9, 3.8528100381107397`*^9}, {
   3.852813472200387*^9, 3.852813650685577*^9}, 3.852813685986403*^9, {
   3.852813726169606*^9, 3.852813901350273*^9}, {3.8528140329377537`*^9, 
   3.852814117365644*^9}, {3.852814149430423*^9, 3.852814152107826*^9}, {
   3.852814188568592*^9, 3.85281419959155*^9}, {3.85281482035562*^9, 
   3.852814823432653*^9}, {3.8528148628844023`*^9, 3.852814906070365*^9}, {
   3.8528150328817797`*^9, 3.852815148143121*^9}, {3.852815368331394*^9, 
   3.852815396914207*^9}, {3.852815434560829*^9, 3.85281546886654*^9}, {
   3.852815561599702*^9, 3.8528156115331507`*^9}, {3.852815690031973*^9, 
   3.852815719543229*^9}, {3.852815750794557*^9, 3.852815779300803*^9}, {
   3.852815875061758*^9, 3.852815902026252*^9}, {3.8528159552077503`*^9, 
   3.852816027512589*^9}, {3.852816086369424*^9, 3.8528161548578377`*^9}, {
   3.852816185638904*^9, 3.852816187549818*^9}, {3.852816222538229*^9, 
   3.852816250613483*^9}, 3.8528163356504707`*^9, {3.852816384046754*^9, 
   3.85281639147079*^9}, {3.852816422951647*^9, 3.8528164328985987`*^9}, {
   3.852816560815536*^9, 3.8528166585236473`*^9}, {3.852816716002564*^9, 
   3.8528167662789717`*^9}, 3.8528168692100277`*^9, {3.852817080127101*^9, 
   3.852817117221737*^9}, {3.852817299277647*^9, 3.852817346911738*^9}, {
   3.852884679708253*^9, 3.85288472615543*^9}, 3.852884758482916*^9, {
   3.8528851090339327`*^9, 3.852885118538569*^9}, {3.852885154979723*^9, 
   3.852885155565287*^9}, 3.8528851945618973`*^9, {3.852885350033947*^9, 
   3.8528854268459682`*^9}, {3.8528854704169493`*^9, 3.852885526046525*^9}, {
   3.852885610965828*^9, 3.852885676472526*^9}, {3.8528857406654177`*^9, 
   3.852885857975627*^9}, {3.852885938336029*^9, 3.852886000641203*^9}, {
   3.852886036341208*^9, 3.852886200702113*^9}, {3.852887755069055*^9, 
   3.852887760425762*^9}, {3.8529787070203876`*^9, 3.8529787279785767`*^9}, {
   3.852978767406361*^9, 3.852978782421542*^9}, {3.852978829276958*^9, 
   3.852978924037402*^9}, {3.852978979282062*^9, 3.852979008913496*^9}, {
   3.852979043709436*^9, 3.852979087958651*^9}, {3.8529792342718887`*^9, 
   3.852979238216951*^9}, {3.852979450466475*^9, 3.852979601924211*^9}, {
   3.852979682613008*^9, 3.852979742940357*^9}, {3.852979832497159*^9, 
   3.8529799574161882`*^9}, {3.852979998907886*^9, 3.852980063717304*^9}, {
   3.852980098915289*^9, 3.852980161791238*^9}, {3.85298022341296*^9, 
   3.852980225532148*^9}, {3.8529802632729597`*^9, 3.8529803433644333`*^9}, {
   3.852980524423443*^9, 3.852980547922299*^9}, {3.8529806112622547`*^9, 
   3.85298070867204*^9}, {3.8529807576608*^9, 3.852980767215754*^9}, {
   3.852980849104878*^9, 3.852980849926909*^9}, {3.852980906906227*^9, 
   3.852980914435383*^9}, {3.852980951882229*^9, 3.852980985601289*^9}, {
   3.852981029071068*^9, 3.852981042143194*^9}, {3.852981075566189*^9, 
   3.852981172656908*^9}, {3.852981209018764*^9, 3.852981216253491*^9}, {
   3.852981251139751*^9, 3.852981311586526*^9}, 3.852981343826339*^9, {
   3.852981375104759*^9, 3.852981428415444*^9}, {3.852981761936139*^9, 
   3.8529819331446457`*^9}, 3.852982533085968*^9, {3.8529825664635477`*^9, 
   3.852982568761834*^9}, 3.852982729513033*^9, {3.85298280850492*^9, 
   3.852982823472494*^9}, {3.852982870439797*^9, 3.852982972130417*^9}, 
   3.852983225192645*^9, {3.8530404828095493`*^9, 3.85304050035637*^9}, {
   3.8530412375588703`*^9, 3.8530413053837633`*^9}, 3.8530413440727377`*^9, 
   3.853041388227624*^9, {3.8530414263425694`*^9, 3.853041441243637*^9}, {
   3.853041547842184*^9, 3.853041558707424*^9}, {3.853041659143627*^9, 
   3.8530416692433643`*^9}, 3.853041768172744*^9, {3.8530419361086893`*^9, 
   3.853041983240382*^9}, {3.853042091470574*^9, 3.853042259815783*^9}, {
   3.8530423102453327`*^9, 3.853042442043128*^9}, {3.853042480437138*^9, 
   3.853042557307132*^9}, {3.853042694558672*^9, 3.853042709323621*^9}, 
   3.853042745931945*^9, {3.8530427938908243`*^9, 3.8530429605972843`*^9}, {
   3.853043009944887*^9, 3.853043034182127*^9}, {3.8530430679380417`*^9, 
   3.853043086792089*^9}, {3.853043122291326*^9, 3.853043137202178*^9}, {
   3.853043348979447*^9, 3.8530433748301773`*^9}, {3.853043406532195*^9, 
   3.8530434281385393`*^9}, {3.853043466094887*^9, 3.8530434683252687`*^9}, {
   3.8530435110865307`*^9, 3.853043609870007*^9}, {3.853043773302196*^9, 
   3.853043870629424*^9}, {3.853043960703788*^9, 3.853044027926787*^9}, {
   3.853044072898715*^9, 3.853044130917831*^9}, {3.853044173163795*^9, 
   3.853044260665155*^9}, {3.8530445721400833`*^9, 3.85304458234986*^9}, 
   3.85304461661755*^9, 3.853044724962384*^9, 3.853044793583387*^9, {
   3.8530449197957478`*^9, 3.8530449211259623`*^9}, {3.853047438082165*^9, 
   3.853047441171585*^9}, {3.853048179734437*^9, 3.8530482164577*^9}, {
   3.85312641884559*^9, 3.853126428473514*^9}, {3.853126548584545*^9, 
   3.85312661049057*^9}, {3.853126705502201*^9, 3.853126769322402*^9}, {
   3.853129238535121*^9, 3.8531292406896133`*^9}, {3.8531294110024757`*^9, 
   3.8531294154034643`*^9}, {3.853130068221118*^9, 3.853130088609592*^9}, {
   3.853130120845765*^9, 3.853130170631444*^9}, 3.853130276830649*^9, {
   3.853130312756393*^9, 3.853130324192915*^9}, {3.853130416661145*^9, 
   3.853130422331546*^9}, {3.8531311004847517`*^9, 3.853131144916813*^9}, {
   3.853131181163629*^9, 3.853131184455991*^9}, {3.853131549150525*^9, 
   3.853131566680307*^9}, {3.8531318859412518`*^9, 3.853131902945826*^9}, {
   3.853157702170267*^9, 3.853157716982478*^9}, {3.853585103607459*^9, 
   3.853585103877925*^9}, {3.8535851636138144`*^9, 3.853585164599341*^9}, {
   3.853667868265408*^9, 3.85366800984284*^9}, {3.853668052109242*^9, 
   3.8536681167292643`*^9}, {3.853668153578844*^9, 3.853668239921953*^9}, {
   3.853668291385195*^9, 3.853668369458186*^9}, {3.853668485543378*^9, 
   3.853668512241939*^9}, {3.853668716659547*^9, 3.853668797969396*^9}, {
   3.85366883548283*^9, 3.853668836151537*^9}, {3.8536689028371143`*^9, 
   3.853668911691431*^9}, {3.85366895097281*^9, 3.853668962634604*^9}, {
   3.8536690272090673`*^9, 3.8536691410281897`*^9}, {3.853669172117485*^9, 
   3.853669174830698*^9}, {3.853669206554296*^9, 3.853669239201413*^9}, 
   3.853669290014269*^9, {3.853669330191461*^9, 3.853669389926713*^9}, {
   3.853669425860519*^9, 3.8536694535634727`*^9}, {3.8536695129546413`*^9, 
   3.853669531818379*^9}, {3.853669583361342*^9, 3.853669638680245*^9}, {
   3.8536696939016953`*^9, 3.853669899955779*^9}, {3.8536700689589643`*^9, 
   3.853670073227734*^9}, {3.85367066430978*^9, 3.853670776675267*^9}, {
   3.853670875303183*^9, 3.853671001804579*^9}, {3.8536710535327177`*^9, 
   3.853671059897114*^9}, {3.8536711091253157`*^9, 3.853671113200395*^9}, {
   3.853675259459915*^9, 3.853675277779236*^9}, {3.8536763442388163`*^9, 
   3.853676344378886*^9}, {3.85367644872029*^9, 3.853676476105592*^9}, {
   3.85367654257552*^9, 3.853676556202215*^9}, {3.853676587646029*^9, 
   3.8536766118818903`*^9}, {3.8536766496893473`*^9, 3.853676746267292*^9}, {
   3.853676800311447*^9, 3.853676839305249*^9}, {3.8536768880248127`*^9, 
   3.853676914167263*^9}, {3.85367698764475*^9, 3.85367709061304*^9}, {
   3.853677223078413*^9, 3.8536772434232483`*^9}, 3.853681575325564*^9, {
   3.853681739246111*^9, 3.853681805915749*^9}, {3.853681889395917*^9, 
   3.853681936085557*^9}, {3.853837165841959*^9, 3.853837166526031*^9}, {
   3.853838222852236*^9, 3.8538382238689404`*^9}, 3.853838314098949*^9, {
   3.853838379194216*^9, 3.853838395682953*^9}, 3.853844603686214*^9, {
   3.8538446439001007`*^9, 3.853844660901516*^9}, {3.853844705544203*^9, 
   3.853844710127338*^9}, {3.853845243612404*^9, 3.853845351088224*^9}, {
   3.853845582118532*^9, 3.853845583314905*^9}, {3.853846637292478*^9, 
   3.8538466377862167`*^9}, 3.853847343886097*^9, 3.853850889351593*^9, {
   3.853853866906887*^9, 3.853853877960887*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[29]:=",ExpressionUUID->"78d4b92e-d1e0-4118-a00b-af22209f793b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation Example 2D", "Section",
 CellChangeTimes->{{3.8536753240084877`*^9, 3.853675327945015*^9}, {
  3.853851494452677*^9, 
  3.853851495412066*^9}},ExpressionUUID->"0ea7cb8d-d13e-4871-92b4-\
5a5c8d005a30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sideLength", " ", "=", " ", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", 
   RowBox[{"HardcorePointProcess", "[", 
    RowBox[{"10", ",", "2", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reg", " ", "=", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "sideLength"}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "/", "2"}]}], ",", 
     RowBox[{"sideLength", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "/", "2"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"particles", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"RandomPointConfiguration", "[", 
      RowBox[{"proc", ",", "reg"}], "]"}], "[", "\"\<Points\>\"", "]"}], "//",
     "Quiet"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"internalParticles", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"terminatingParticles", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graphic", " ", "=", " ", 
   RowBox[{"polymerGraphic", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "particles", ",", "terminatingParticles", ",", "internalParticles"}], 
      "}"}], ",", " ", "sideLength"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8531579856213007`*^9, 3.8531579920067453`*^9}, {
   3.853584276560918*^9, 3.853584278833015*^9}, {3.853584402737167*^9, 
   3.853584402776928*^9}, {3.8536753392154503`*^9, 3.85367538182125*^9}, {
   3.853675435285668*^9, 3.853675474493148*^9}, 3.85368079492593*^9, {
   3.853681016116197*^9, 3.853681026342771*^9}, 3.8538508199760437`*^9, {
   3.853851136280609*^9, 3.8538511368423843`*^9}, {3.853851524007587*^9, 
   3.853851524400951*^9}, {3.8538593289016647`*^9, 3.853859345997093*^9}, {
   3.8538594555398283`*^9, 3.853859455574733*^9}},
 CellLabel->
  "2/14/22 21:30:57 (extra_kernel) \
In[72]:=",ExpressionUUID->"937888af-3ac6-49b6-87de-637a31998d87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", "graphic", "]"}]], "Input",
 CellChangeTimes->{{3.853675549451961*^9, 3.8536755529182997`*^9}, {
  3.853681029143943*^9, 3.853681061585331*^9}, {3.853850708623702*^9, 
  3.853850710861505*^9}},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[37]:=",ExpressionUUID->"71ed5353-07d3-4997-8637-f67b051fd971"],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`graphic, StandardForm],
  ImageSizeCache->{500., {247., 253.}}]], "Output",
 CellChangeTimes->{3.853859297729928*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
Out[37]=",ExpressionUUID->"c40ef5a8-f50c-4296-ad82-f67d254375fa"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.853838291080916*^9, 3.853838347105569*^9}, 
   3.853850880094348*^9},
 CellLabel->
  "2/14/22 21:28:17 (extra_kernel) \
In[38]:=",ExpressionUUID->"0401ea73-e47d-45dc-bedc-dca232a560f6"],

Cell[BoxData[
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "particles", "]"}], ">", " ", "1"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "particles", ",", "terminatingParticles", ",", "internalParticles"}], 
      "}"}], "=", " ", 
     RowBox[{"updateParticles", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "particles", ",", "terminatingParticles", ",", "internalParticles"}], 
        "}"}], ",", ".2", ",", 
       RowBox[{"sideLength", "/", "2"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"graphic", " ", "=", " ", 
     RowBox[{"polymerGraphic", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "particles", ",", "terminatingParticles", ",", "internalParticles"}], 
        "}"}], ",", " ", "sideLength"}], "]"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.85367553051045*^9, 3.853675547195343*^9}, {
   3.8536756591342697`*^9, 3.853675659323781*^9}, 3.8536760089448338`*^9, {
   3.8536798112623672`*^9, 3.8536798130576773`*^9}, {3.853679998617611*^9, 
   3.853680021276279*^9}, {3.853680624813768*^9, 3.853680683331633*^9}, {
   3.853681071847351*^9, 3.853681078055561*^9}, {3.85383825623182*^9, 
   3.853838268117703*^9}, {3.853838352191564*^9, 3.853838366210581*^9}, {
   3.853850673042379*^9, 3.853850673395426*^9}, {3.8538507184879704`*^9, 
   3.8538507199679203`*^9}, {3.853850771212977*^9, 3.853850774938345*^9}, {
   3.853850826391328*^9, 3.853850826675239*^9}, {3.8538508710238132`*^9, 
   3.853850876720995*^9}, {3.853851376167254*^9, 3.8538513852881393`*^9}, {
   3.853851417794345*^9, 3.853851417921563*^9}, {3.853851458215868*^9, 
   3.853851466212554*^9}, {3.8538515150382767`*^9, 3.8538515172303753`*^9}},
 CellLabel->
  "2/14/22 21:31:00 (extra_kernel) \
In[79]:=",ExpressionUUID->"a6044d44-50d6-4407-b166-e3ae02e3c280"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation Example 3D", "Section",
 CellChangeTimes->{{3.8536753240084877`*^9, 3.853675327945015*^9}, {
  3.853851494452677*^9, 3.853851495412066*^9}, {3.8538519984350433`*^9, 
  3.853851998722048*^9}},ExpressionUUID->"f07e7c39-d526-4bca-9768-\
7f4a76c0463b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sideLength", " ", "=", " ", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", 
   RowBox[{"HardcorePointProcess", "[", 
    RowBox[{"10", ",", "2", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reg", " ", "=", 
   RowBox[{"Cuboid", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "sideLength"}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], "/", "2"}]}], ",", 
     RowBox[{"sideLength", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], "/", "2"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"particles", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"RandomPointConfiguration", "[", 
      RowBox[{"proc", ",", "reg"}], "]"}], "[", "\"\<Points\>\"", "]"}], "//",
     "Quiet"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"internalParticles", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"terminatingParticles", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graphic", " ", "=", " ", 
   RowBox[{"polymerGraphic", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "particles", ",", "terminatingParticles", ",", "internalParticles"}], 
      "}"}], ",", " ", "sideLength"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8531579856213007`*^9, 3.8531579920067453`*^9}, {
   3.853584276560918*^9, 3.853584278833015*^9}, {3.853584402737167*^9, 
   3.853584402776928*^9}, {3.8536753392154503`*^9, 3.85367538182125*^9}, {
   3.853675435285668*^9, 3.853675474493148*^9}, 3.85368079492593*^9, {
   3.853681016116197*^9, 3.853681026342771*^9}, 3.8538508199760437`*^9, {
   3.853851136280609*^9, 3.8538511368423843`*^9}, {3.853851524007587*^9, 
   3.853851524400951*^9}, {3.853853619931324*^9, 3.85385363245367*^9}},
 CellLabel->
  "2/14/22 19:53:56 (extra_kernel) \
In[712]:=",ExpressionUUID->"c615a560-051c-4a04-ab02-6dfc631cccb1"],

Cell["Run the above While command again.", "Text",
 CellChangeTimes->{{3.8538537248909473`*^9, 
  3.853853739104603*^9}},ExpressionUUID->"8fc27e04-7e23-46f3-a167-\
d6f7c16c5c03"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Discussion", "Section",
 CellChangeTimes->{{3.8539034720385523`*^9, 
  3.853903474542717*^9}},ExpressionUUID->"beb92642-4b6c-4cca-9ea6-\
088cf4185b05"],

Cell["\<\
This simulation fails to simulate the behavior of step-wise growth and it is \
instructive to understand why.

Experimental observations show that dimers react to form tetramers, tetramers \
and dimers to form hexamers, and on.  Our simulation prevents these higher \
order reactions from occurring because only the singlets to move.

In a separate chapter, we will develop an algorithm for the collective motion \
of polymer chains and then combine these algorithms for a better simulation \
of step-wise polymerization.\
\>", "Subsubsection",
 CellChangeTimes->{{3.853903481027924*^9, 3.853903500362856*^9}, {
  3.853903563129739*^9, 
  3.85390387098558*^9}},ExpressionUUID->"d5a61e83-264a-41fe-a227-\
23eeaf745596"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1248, 847},
WindowMargins->{{74, Automatic}, {Automatic, 52}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b095ab44-982e-420a-9834-b86af5641caf"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 249, 6, 84, "Section",ExpressionUUID->"4859a45a-a556-441d-9860-1655e4c4980a"],
Cell[810, 28, 229, 9, 208, "Section",ExpressionUUID->"13014e8c-0b8f-4b45-82e5-a22c9ee8d605"],
Cell[CellGroupData[{
Cell[1064, 41, 185, 3, 71, "Chapter",ExpressionUUID->"aa788034-b1b7-4089-beb6-45e7017f573d"],
Cell[CellGroupData[{
Cell[1274, 48, 26836, 455, 1061, "Section",ExpressionUUID->"8015691d-190d-499d-9c09-76e7f12242aa"],
Cell[CellGroupData[{
Cell[28135, 507, 449, 10, 167, "Subsection",ExpressionUUID->"1d2a7260-8233-4a11-9ba4-3698cfab8a6d"],
Cell[28587, 519, 416, 8, 51, "Input",ExpressionUUID->"2aff80b9-404e-432f-973c-717f68601f91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29040, 532, 315, 7, 101, "Subsection",ExpressionUUID->"ceeb8904-1738-4de9-9b38-4bdf41857a3b"],
Cell[29358, 541, 1576, 30, 78, "Input",ExpressionUUID->"e3e13eaa-b10c-4e7c-b135-aa391d301a47",
 CellID->361480177]
}, Open  ]],
Cell[CellGroupData[{
Cell[30971, 576, 173, 3, 67, "Subsection",ExpressionUUID->"a9a5b5a1-5314-4012-89e3-ffcf6c685038"],
Cell[31147, 581, 1360, 39, 104, "Input",ExpressionUUID->"e829efaf-bf07-431a-ac43-ae9e6c8f50ce",
 CellID->150792824]
}, Open  ]],
Cell[CellGroupData[{
Cell[32544, 625, 162, 3, 67, "Subsection",ExpressionUUID->"f148a25d-245b-4426-8f03-2fce85384a39"],
Cell[32709, 630, 427, 10, 51, "Input",ExpressionUUID->"543cafec-2a36-4ef6-bd75-022ea8e7a989",
 CellID->32148238],
Cell[CellGroupData[{
Cell[33161, 644, 483, 13, 51, "Input",ExpressionUUID->"eafbe795-9b65-400d-8b77-5d33023868be"],
Cell[33647, 659, 1884, 43, 479, "Output",ExpressionUUID->"a0cfb783-b07d-473e-8c9d-dbc4653f0f44"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35580, 708, 522, 10, 134, "Subsection",ExpressionUUID->"471e86f1-70ad-4791-ac32-74450653b617"],
Cell[36105, 720, 4477, 106, 676, "Input",ExpressionUUID->"f85d1bb9-0cc6-442e-9971-3b78c5689402"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40631, 832, 195, 3, 84, "Section",ExpressionUUID->"197c1b0b-a8ac-48d6-b901-20fb3f01c092"],
Cell[CellGroupData[{
Cell[40851, 839, 190, 3, 67, "Subsection",ExpressionUUID->"3a49a317-f517-4dc0-b0a7-52e44e9a20ac"],
Cell[41044, 844, 1235, 34, 78, "Input",ExpressionUUID->"8f871d13-d929-492e-94ec-4b643e0afb5a"],
Cell[CellGroupData[{
Cell[42304, 882, 392, 10, 51, "Input",ExpressionUUID->"d63aef78-db0e-4645-b468-adfd6ba781c7"],
Cell[42699, 894, 763, 19, 535, "Output",ExpressionUUID->"0a780998-a202-4d5a-9a67-3204993497a1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43511, 919, 519, 9, 101, "Subsection",ExpressionUUID->"c7f4f041-77be-4e93-8b2f-c917ff12e54c"],
Cell[CellGroupData[{
Cell[44055, 932, 302, 7, 89, "Subsubsection",ExpressionUUID->"20493f58-f2a4-497c-8a5c-3af33d28d25c"],
Cell[CellGroupData[{
Cell[44382, 943, 319, 7, 51, "Input",ExpressionUUID->"d6acbe9c-8cf4-4a2c-98e0-3915d2eedb29"],
Cell[44704, 952, 7858, 169, 92, "Output",ExpressionUUID->"57e0d9fd-e6d6-4707-af55-0d1880e3b2dd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52611, 1127, 223, 5, 56, "Subsubsection",ExpressionUUID->"4d0ff029-e876-4d7d-bf31-b9d2a59d3ae5"],
Cell[CellGroupData[{
Cell[52859, 1136, 294, 7, 51, "Input",ExpressionUUID->"9b77817e-be23-4337-8a11-8fa88254841a"],
Cell[53156, 1145, 542, 13, 56, "Output",ExpressionUUID->"1f381e98-2182-49c4-82db-c21abde2b907"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53747, 1164, 214, 4, 56, "Subsubsection",ExpressionUUID->"362647b2-3d29-48c7-b46b-c692678c8da4"],
Cell[CellGroupData[{
Cell[53986, 1172, 326, 8, 51, "Input",ExpressionUUID->"81f8da61-258e-4f70-bc54-3153bde4b743"],
Cell[54315, 1182, 915, 24, 83, "Output",ExpressionUUID->"272eed53-8197-4b7f-9e16-780f2986b056"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55279, 1212, 483, 11, 153, "Subsubsection",ExpressionUUID->"3144872b-32af-471f-a8d9-22f0e99c74bc"],
Cell[CellGroupData[{
Cell[55787, 1227, 401, 9, 51, "Input",ExpressionUUID->"b79da110-36fc-4eee-b287-ea47614e00d3"],
Cell[56191, 1238, 3873, 103, 239, "Output",ExpressionUUID->"638a9a7f-57e6-4853-8987-386bd26c4b1a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60113, 1347, 1058, 24, 250, "Subsubsection",ExpressionUUID->"db3d922f-717f-4930-b951-ec3715138b33"],
Cell[CellGroupData[{
Cell[61196, 1375, 1264, 29, 104, "Input",ExpressionUUID->"e0cc143b-7635-4420-b075-682354f776a8"],
Cell[62463, 1406, 4548, 118, 247, "Output",ExpressionUUID->"e36a6db2-e544-4e7d-b741-bfa0f89f24ca"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[67060, 1530, 323, 5, 56, "Subsubsection",ExpressionUUID->"b0114f70-d9db-4be1-819c-3ca22199f944"],
Cell[CellGroupData[{
Cell[67408, 1539, 1392, 36, 156, "Input",ExpressionUUID->"72c3b3f4-b4f9-44c6-baf3-49567365b9a6"],
Cell[68803, 1577, 2289, 58, 161, "Output",ExpressionUUID->"9189a00c-6c0c-40f8-ba4d-f79f6117a791"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71153, 1642, 551, 10, 101, "Subsection",ExpressionUUID->"cf9ce07b-1c6a-41c0-8dd7-eca44061625e"],
Cell[71707, 1654, 1558, 41, 260, "Input",ExpressionUUID->"2f910598-aadd-4153-8b2d-706138a9e23b"],
Cell[CellGroupData[{
Cell[73290, 1699, 381, 6, 56, "Subsubsection",ExpressionUUID->"7059ec1a-e736-4817-a38c-f8c2e9eb8f48"],
Cell[CellGroupData[{
Cell[73696, 1709, 357, 9, 51, "Input",ExpressionUUID->"74b131f0-c460-4429-a632-52282e4c6b8c"],
Cell[74056, 1720, 203, 5, 56, "Output",ExpressionUUID->"a565a8e7-a88c-42b8-8989-9892b86fcfda"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74320, 1732, 198, 3, 67, "Subsection",ExpressionUUID->"f3b671c7-03ba-4c93-a776-1173c917301e"],
Cell[74521, 1737, 2071, 51, 234, "Input",ExpressionUUID->"65cc338d-b4f9-414f-b618-0c00fe03e62a"],
Cell[CellGroupData[{
Cell[76617, 1792, 429, 8, 121, "Subsubsection",ExpressionUUID->"42107a55-a5c9-4a89-b895-e2e31f2f026f"],
Cell[77049, 1802, 413, 8, 44, "Text",ExpressionUUID->"9dbe7e56-7f7b-4550-b087-3800e9f6712b"],
Cell[77465, 1812, 3643, 78, 416, "Input",ExpressionUUID->"d5f407a9-12e3-474d-aaf6-674500b0e08b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81169, 1897, 339, 7, 132, "Section",ExpressionUUID->"bcd3c881-faef-441b-972f-783580b3f1ab"],
Cell[CellGroupData[{
Cell[81533, 1908, 248, 5, 56, "Subsubsection",ExpressionUUID->"4b775aed-235c-43ad-ba4d-9bf47d4c2177"],
Cell[81784, 1915, 3877, 101, 321, "Input",ExpressionUUID->"1bf0ade0-778c-41f8-9f53-b48473a9c2ff",
 CellID->1782067018],
Cell[CellGroupData[{
Cell[85686, 2020, 400, 10, 51, "Input",ExpressionUUID->"b8d68d91-3f5c-426c-becb-bdeacd72d567"],
Cell[86089, 2032, 14456, 296, 535, "Output",ExpressionUUID->"775aad53-38fe-4f6c-9594-400cafe57a16"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100594, 2334, 923, 15, 218, "Subsubsection",ExpressionUUID->"d8f61233-2fe6-4f65-9b14-78f113ce9e80"],
Cell[101520, 2351, 2074, 49, 286, "Input",ExpressionUUID->"68ed6c05-a306-46e1-b0c5-0f9778f91483"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[103643, 2406, 315, 6, 84, "Section",ExpressionUUID->"562b2825-307e-4438-9210-839d889df8c8"],
Cell[103961, 2414, 539, 10, 121, "Subsubsection",ExpressionUUID->"cf8ba666-d3da-461c-b3f8-e1c35221bfb0"],
Cell[CellGroupData[{
Cell[104525, 2428, 226, 5, 45, "Subsubsection",ExpressionUUID->"7c56d714-ec70-4226-9560-8b19c90cc250"],
Cell[CellGroupData[{
Cell[104776, 2437, 369, 8, 51, "Input",ExpressionUUID->"9baa3905-1b0b-4a8c-8792-e25eb45e775d"],
Cell[105148, 2447, 953, 25, 83, "Output",ExpressionUUID->"10756ea6-d811-429d-b191-1f78efee465f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[106150, 2478, 360, 7, 56, "Subsubsection",ExpressionUUID->"c166485e-caae-4bd3-951a-72ae4cc44e5d"],
Cell[106513, 2487, 4441, 103, 546, "Input",ExpressionUUID->"aa828bf9-639c-46eb-aec1-d7d5b700a8ab"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[111003, 2596, 313, 5, 84, "Section",ExpressionUUID->"bc86c625-4b15-4a59-b91d-6bcfd0fe3197"],
Cell[CellGroupData[{
Cell[111341, 2605, 561, 10, 153, "Subsubsection",ExpressionUUID->"c292f86d-2d84-41e9-b7c1-830a23019d0c"],
Cell[111905, 2617, 386, 8, 73, "Text",ExpressionUUID->"45361c51-8049-4727-9867-dc45d2f4b803"],
Cell[112294, 2627, 19586, 356, 2002, "Input",ExpressionUUID->"78d4b92e-d1e0-4118-a00b-af22209f793b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131929, 2989, 217, 4, 84, "Section",ExpressionUUID->"0ea7cb8d-d13e-4871-92b4-5a5c8d005a30"],
Cell[132149, 2995, 2047, 52, 208, "Input",ExpressionUUID->"937888af-3ac6-49b6-87de-637a31998d87"],
Cell[CellGroupData[{
Cell[134221, 3051, 348, 7, 51, "Input",ExpressionUUID->"71ed5353-07d3-4997-8637-f67b051fd971"],
Cell[134572, 3060, 280, 6, 535, "Output",ExpressionUUID->"c40ef5a8-f50c-4296-ad82-f67d254375fa"]
}, Open  ]],
Cell[134867, 3069, 234, 5, 51, "Input",ExpressionUUID->"0401ea73-e47d-45dc-bedc-dca232a560f6"],
Cell[135104, 3076, 1912, 42, 156, "Input",ExpressionUUID->"a6044d44-50d6-4407-b166-e3ae02e3c280"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137053, 3123, 265, 4, 84, "Section",ExpressionUUID->"f07e7c39-d526-4bca-9768-7f4a76c0463b"],
Cell[137321, 3129, 2010, 51, 208, "Input",ExpressionUUID->"c615a560-051c-4a04-ab02-6dfc631cccb1"],
Cell[139334, 3182, 178, 3, 44, "Text",ExpressionUUID->"8fc27e04-7e23-46f3-a167-d6f7c16c5c03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139549, 3190, 157, 3, 84, "Section",ExpressionUUID->"beb92642-4b6c-4cca-9ea6-088cf4185b05"],
Cell[139709, 3195, 728, 15, 250, "Subsubsection",ExpressionUUID->"d5a61e83-264a-41fe-a227-23eeaf745596"]
}, Open  ]]
}, Open  ]]
}
]
*)

